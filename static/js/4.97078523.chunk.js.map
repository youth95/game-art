{"version":3,"sources":["components/canvas/bitmap/BitMap.ts","components/canvas/bitmap/Color.ts","components/canvas/bitmap/index.ts","components/accordion/Accordion.tsx","components/bins.ts","components/icon/BinIcon.tsx","components/accordion/AccordionPanel.tsx","hooks/utils.ts","components/canvas/types.ts","hooks/useEntryTable.ts","context/EditorContext.tsx","hooks/useToggle.ts","components/canvas/PixelBoard.tsx","components/canvas/Canvas.tsx","hooks/useStask.ts","components/canvas/ColorBitMapRender.tsx","components/canvas/ColorBitMapPreview.tsx","components/list/BlockGroupList/BlockGroupList.tsx","components/form/BlockGroupPropsForm.tsx","pages/BlockGroupSelectPanel.tsx","components/canvas/Palette.tsx","pages/ToolBar.tsx","pages/BlockEditor.tsx","pages/SpirtEditor.tsx","pages/index.tsx","components/canvas/utils.ts"],"names":["clamp","min","max","v","BitMap","width","height","fv","values","Error","this","Array","fill","map","clone","fillValue","m","y","x","put","get","x0","y0","x1","y1","self","cwl","chl","sy","ex","ey","fitV","aimC","eq","queue","vist","join","length","shift","_x","_y","filter","a","b","undefined","forEach","pit","push","shapeEq","result","diff","Color","r","g","none","black","white","AccordionContext","React","createContext","Accordion","props","children","defaultActive","Container","S","useState","activeID","setActiveID","fullHeight","setFullHeight","containerRef","useRef","useEffect","current","offsetHeight","resize","window","addEventListener","removeEventListener","panelHeight","useMemo","isArray","Provider","value","ref","styled","div","toDataURL","bin","bitMap2Image","base642BitMap","BW2x2","data","BW2x2_DATA_URL","ICON_RESIZE32x32_DATA_URL","ICON_ADD_FILE22x22_DATA_URL","ICON_UP16x16_DATA_URL","ICON_DOWN16x16_DATA_URL","ICON_RIGHT16x16_DATA_URL","CURSOR_PANCEL32x32_DATA_URL","CURSOR_BUCKET32x32_DATA_URL","BinIcon","type","onClick","size","style","AccordionPanel","id","title","actionRender","Panel","Title","Header","Action","useContext","useHover","hoved","e","stopPropagation","isShow","el","useFnReducer","initState","useReducer","state","afn","useProduce","_dispatch","changeFn","produce","DrawMode","DrawTool","insert","dispatch","entries","draft","entry","autoID","removeById","updateById","removeByFilter","Object","item","reduce","sum","updateByMapper","mapper","useEntryTable","table","EditorContext","useEditorContext","useEditorContextStore","options","set","Proxy","_","p","darft","useSetter","color","grid","pixelSize","pos","tool","pancel","drawMode","normal","activeBitMapID","setActiveBitMapID","blockGroups","colorBitMaps","useKeyPressEvent","key","bucket","lrs","uds","centrosymmetry","appendBlockGroup","name","groupWidth","groupHeight","blockSize","groupID","EditorContextProvder","toggleReducer","nextValue","useToggle","initialValue","clap","PixelBoard","onMouseDown","onMouseLeave","onMouseMove","onMouseUp","useMouse","elX","elY","Math","floor","usePixelBoard","Board","gridStyle","backgroundImage","backgroundSize","borderRight","borderBottom","border","minWidth","maxWidth","minHeight","maxHeight","Canvas","onOperationFinish","bitMap","onBitMapChange","preview","canvas","isDown","toggleDU","backgroundImageURL","ctx","getContext","putImageData","bitMap2ImageData","fillRect","pencelDraw","bx","by","bucketDraw","fillArea","draw","handleMouseDown","handleMouseUp","handleMouseMove","DrawCanvas","cursor","useUndo","defaultValue","setData","top","pop","slice","clear","useStask","useKey","event","metaKey","preventDefault","bit","ColorBitMapRender","createRef","c","fillStyle","backgroundColor","backgroundRepeat","ColorBitMapPreview","build","pipe","_size","document","createElement","getImageData","buildCanvas","root","append","wrap","label","textContent","appendChild","bex","bild","effect","invert","sepia","emboss","grayscale","sharpen","sobel","img","dilate","edge_detection","erode","grayscale_with_weights","median","unsharp_mask","display","gridTemplateColumns","gridGap","BlockGroupList","BlockGroupItem","BlockSelectPanel","Grid","Placeholder","blockGroup","colorBitMap","BlockContainer","overflow","useBlockGroupPropsForm","setGroupWidth","setGroupHeight","setBlockSize","setName","PureBlockGroupPropsForm","Item","onChange","target","BlockGroupSelectPanel","isVisible","toggle","blockGroupPropsFormState","visible","onCancel","onOk","Palette","onChangeColor","defaultColorList","useList","colorList","updateAt","activeColorIndex","findIndex","onClickHandle","idx","keyDown","useKeyPress","isChangeColorModialVisible","split","includes","ColorBlock","ColorBlockContainer","KeyBoardTip","cl","rgba","acitve","position","left","zIndex","res","rgb","ToolBar","InlineBlock","setVisible","handleCanvasOperationFinish","useCopyToClipboard","copy","activeBitMap","Group","buttonStyle","Button","href","footer","JSON","stringify","bitMap2Base64","message","success","BlockEditor","CanvasContainer","SpirtEditor","ObjectNavigation","Editor","imageData","Uint8ClampedArray","ImageData","bitMap2Bin","Buffer","buffer","toString","from","imageData2BitMap"],"mappings":"oKAEMA,EAAQ,SAACC,EAAaC,GAAd,OAA8B,SAACC,GAC3C,OAAIA,EAAIF,EACCA,EACEE,EAAID,EACNA,EAEAC,IAQEC,EAAb,WAIE,WACkBC,EACAC,EAChBC,GAEA,GADC,yBAHeF,QAGhB,KAFgBC,SAEhB,KANKE,YAML,EACIH,GAAS,GAAKC,GAAU,EAC1B,MAAM,IAAIG,MAAJ,kCAERC,KAAKF,OAAS,IAAIG,MAAMN,EAAQC,GAAQM,KAAK,GAAGC,KAAI,kBAAMN,EAAGO,WAZjE,iDAoBOX,GACH,OAAO,IAAIC,EAAOM,KAAKL,MAAOK,KAAKJ,OAAQH,EAAEW,WArBjD,iCA+BaC,GAAoF,IAAtEV,EAAqE,uDAArDK,KAAKL,MAAOC,EAAyC,uDAAxBI,KAAKJ,OACzE,GAAID,IAAUK,KAAKL,OAASC,IAAWI,KAAKJ,OAC1C,OAAOI,KAAKI,QAGd,IADA,IAAME,EAAI,IAAIZ,EAAUC,EAAOC,EAAQS,GAC9BE,EAAI,EAAGA,EAAIP,KAAKJ,OAAQW,IAC/B,IAAK,IAAIC,EAAI,EAAGA,EAAIR,KAAKL,MAAOa,IAC1BA,EAAIF,EAAEX,OAASY,EAAID,EAAEV,QACvBU,EAAEG,IAAID,EAAGD,EAAGP,KAAKU,IAAIF,EAAGD,IAG9B,OAAOD,IA1CX,0BAoDME,EAAWD,GACb,GAAIC,GAAK,GAAKD,GAAK,GAAKC,EAAIR,KAAKL,OAASY,EAAIP,KAAKJ,OAMjD,OAAOI,KAAKF,OAAOS,EAAIP,KAAKL,MAAQa,GAAGJ,QAEvC,MAAML,MAAM,KAAD,OAAMS,EAAN,cAAaD,EAAb,gCA7DjB,0BAwEMC,EAAWD,EAAWd,GACxB,GAAIe,GAAK,GAAKD,GAAK,GAAKC,EAAIR,KAAKL,OAASY,EAAIP,KAAKJ,OAEjD,OADAI,KAAKF,OAAOS,EAAIP,KAAKL,MAAQa,GAAKf,EAAEW,QAC7BJ,KAEP,MAAMD,MAAM,KAAD,OAAMS,EAAN,cAAaD,EAAb,gCA7EjB,+BA0FWI,EAAYC,EAAYC,EAAYC,EAAYrB,GACvD,GAAIkB,EAAKE,GAAMD,EAAKE,EAClB,MAAM,IAAIf,MAAM,8CAMlB,IAJA,IAAMgB,EAAOf,KAAKI,QACZY,EAAM1B,EAAM,EAAGyB,EAAKpB,OACpBsB,EAAM3B,EAAM,EAAGyB,EAAKnB,QAN8C,EAO/C,CAACoB,EAAIL,GAAKM,EAAIL,GAAKI,EAAIH,GAAKI,EAAIH,IAA9CI,EAP6D,KAOzDC,EAPyD,KAOrDC,EAPqD,KAQ/DZ,EAR+D,KAQvDA,EAAIW,EAAIX,IACvB,IAAK,IAAID,EAAIW,EAAIX,EAAIa,EAAIb,IACvBQ,EAAKN,IAAID,EAAGD,EAAGd,GAEnB,OAAOsB,IAtGX,+BAgHWP,EAAWD,EAAWc,GAC7B,IAAMN,EAAOf,KAAKI,QAEZkB,EAAOP,EAAKL,IAAIF,EAAGD,GACzB,GAAIe,EAAKC,GAAGF,GACV,OAAON,EAOT,IALA,IAAMS,EAAQ,CAAC,CAAChB,EAAGD,IACbkB,EAAI,eACP,CAACjB,EAAGD,GAAGmB,KAAK,MAAO,GAGfF,EAAMG,OAAS,GAAG,CACvB,IADuB,EACbH,EAAMI,QADO,mBAEhBC,EAFgB,KAEZC,EAFY,KAGvB,IAAIf,EAAKL,IAAImB,EAAIC,GAAIP,GAAGF,GAGtBN,EAAKN,IAAIoB,EAAIC,EAAIT,GAEA,CACjB,CAACQ,EAAIC,EAAK,GACV,CAACD,EAAK,EAAGC,GACT,CAACD,EAAIC,EAAK,GACV,CAACD,EAAK,EAAGC,IAERC,QAAO,mCAAEC,EAAF,KAAKC,EAAL,YACND,GAAK,GACFC,GAAK,GACLD,EAAIjB,EAAKpB,OACTsC,EAAIlB,EAAKnB,QACTmB,EAAKL,IAAIsB,EAAGC,GAAGV,GAAGD,SACSY,IAA3BT,EAAK,CAACO,EAAGC,GAAGP,KAAK,SAGrBS,SAAQ,SAAAC,GAGPX,EAAKW,EAAIV,KAAK,OAAQ,EACtBF,EAAMa,KAAKD,MAIjB,OAAOrB,IA3JX,2BA8JOtB,GACH,IAAKO,KAAKsC,QAAQ7C,GAChB,MAAM,IAAIM,MAAM,iDAGlB,IADA,IAAMwC,EAAwB,CAAEC,KAAM,IAC7BhC,EAAI,EAAGA,EAAIR,KAAKL,MAAOa,IAC9B,IAAK,IAAID,EAAI,EAAGA,EAAIP,KAAKJ,OAAQW,IAC1BP,KAAKU,IAAIF,EAAGD,GAAGgB,GAAG9B,EAAEiB,IAAIF,EAAGD,KAC9BgC,EAAOC,KAAKH,KAAK,CAAE7B,IAAGD,IAAGd,EAAGO,KAAKU,IAAIF,EAAGD,GAAGH,UAGjD,OAAOmC,IAzKX,8BA4KkB9C,GACd,OAAOA,EAAEE,QAAUK,KAAKL,OAASF,EAAEG,SAAWI,KAAKJ,SA7KvD,yBAqLKH,GACD,IAAKO,KAAKsC,QAAQ7C,GAChB,OAAO,EAET,IAAK,IAAIe,EAAI,EAAGA,EAAIR,KAAKL,MAAOa,IAC9B,IAAK,IAAID,EAAI,EAAGA,EAAIP,KAAKJ,OAAQW,IAC/B,IAAKP,KAAKU,IAAIF,EAAGD,GAAGgB,GAAG9B,EAAEiB,IAAIF,EAAGD,IAC9B,OAAO,EAGb,OAAO,IA/LX,8BAuMI,IADA,IAAMD,EAAI,IAAIZ,EAAUM,KAAKL,MAAOK,KAAKJ,OAAQI,KAAKF,OAAO,IACpDU,EAAI,EAAGA,EAAIR,KAAKL,MAAOa,IAC9B,IAAK,IAAID,EAAI,EAAGA,EAAIP,KAAKJ,OAAQW,IAC/BD,EAAEG,IAAID,EAAGD,EAAGP,KAAKU,IAAIF,EAAGD,IAE5B,OAAOD,MA3MX,M,6GCdamC,EAAb,WAEE,WACkBC,EACAC,EACAV,GAEf,IADeD,EAChB,uDAD4B,EAC5B,yBAJgBU,IAIhB,KAHgBC,IAGhB,KAFgBV,IAEhB,KADgBD,IANpB,+CAmBKvC,GAAoB,IACbiD,EAAe1C,KAAf0C,EAAGC,EAAY3C,KAAZ2C,EAAGV,EAASjC,KAATiC,EAAGD,EAAMhC,KAANgC,EACjB,OAAOU,IAAMjD,EAAEiD,GAAKC,IAAMlD,EAAEkD,GAAKV,IAAMxC,EAAEwC,GAAKD,IAAMvC,EAAEuC,IArB1D,8BAyBI,OAAO,IAAIS,EAAMzC,KAAK0C,EAAG1C,KAAK2C,EAAG3C,KAAKiC,EAAGjC,KAAKgC,KAzBlD,2BAcsB,IACVU,EAAe1C,KAAf0C,EAAGC,EAAY3C,KAAZ2C,EAAGV,EAASjC,KAATiC,EAAGD,EAAMhC,KAANgC,EACjB,MAAM,QAAN,OAAeU,EAAf,YAAoBC,EAApB,YAAyBV,EAAzB,YAA8BD,EAA9B,SAhBJ,KAAaS,EASGG,KAAc,IAAIH,EAAM,EAAG,EAAG,EAAG,GATpCA,EAUGI,MAAe,IAAIJ,EAAM,EAAG,EAAG,GAVlCA,EAWGK,MAAe,IAAIL,EAAM,IAAK,IAAK,IAAK,I,gCCbxD,qL,wOCIA,IAAMM,EAAmBC,IAAMC,mBAK5Bf,GAeI,SAASgB,EAAUC,GAAwB,IAE9CC,EAEED,EAFFC,SACAC,EACEF,EADFE,cAGAC,EACEC,EADFD,UAN6C,EAQfE,mBAAaH,GARE,mBAQxCI,EARwC,KAQ9BC,EAR8B,OASXF,mBAAiB,GATN,mBASxCG,EATwC,KAS5BC,EAT4B,KAUzCC,EAAeC,iBAAuB,MAE5CC,qBAAU,WACR,GAAIF,EAAaG,QAAQC,aAAc,CACrCL,EAAcC,EAAaG,QAAQC,cACnC,IAAMC,EAAS,kBAAMN,EAAcC,EAAaG,QAAQC,eAExD,OADAE,OAAOC,iBAAiB,SAAUF,GAC3B,kBAAMC,OAAOE,oBAAoB,SAAUH,OAEnD,CAACL,IACJ,IAAMS,EAAcC,mBAClB,kBAAMtE,MAAMuE,QAAQpB,GAAYO,EAAa,GAAKP,EAASzB,OAASgC,EAAa,KACjF,CAACA,EAAYP,IAEf,OACE,kBAACL,EAAiB0B,SAAlB,CAA2BC,MAAO,CAAEjB,WAAUE,aAAYW,cAAaZ,gBACrE,kBAACJ,EAAD,CAAWqB,IAAKd,GACbT,IAKT,IAAMG,EAAI,CACRD,UAAWsB,IAAOC,IAAT,M,QCtDEC,EAAY,SAACC,GAAD,OAAcC,YAAaC,YAAcF,GAAM,GAAGD,aAK9DI,EAAa,CACxBtF,OAAQ,EACRD,MAAO,EACPwF,KAAM,4BAGKC,EAAiBN,EAAUI,GAW3BG,EAA4BP,EANJ,CACnC,MAAS,GACT,OAAU,GACV,KAAQ,61KAcGQ,EAA8BR,EANJ,CACrC,MAAS,GACT,OAAU,GACV,KAAQ,6hFAcGS,EAAwBT,EANJ,CAC/B,MAAS,GACT,OAAU,GACV,KAAQ,61CAcGU,EAA0BV,EANJ,CACjC,MAAS,GACT,OAAU,GACV,KAAQ,61CAcGW,EAA2BX,EANJ,CAClC,MAAS,GACT,OAAU,GACV,KAAQ,61CAcGY,EAA8BZ,EANJ,CACrC,MAAS,GACT,OAAU,GACV,KAAQ,61KAcGa,EAA8Bb,EANJ,CACrC,MAAS,GACT,OAAU,GACV,KAAQ,61K,0LC1DH,SAASc,EAAQzC,GAAsB,IAAD,EAEzC0C,EAEE1C,EAFF0C,KACAC,EACE3C,EADF2C,QAEIC,EAAI,UAAG5C,EAAM4C,YAAT,QAAiB,GAEzBzC,EACEC,EADFD,UAEF,OACE,kBAACA,EAAD,CACEuC,KAAMA,EACNG,MAAO,CACLrG,MAAOoG,EACPnG,OAAQmG,GAEVD,QAAS,WACHA,GACFA,OAOV,IAAMvC,EAAI,CACRD,UAAWsB,IAAOC,IAAT,KAGa,SAAA1B,GAClB,OAAQA,EAAM0C,MACZ,IAAK,SAAU,MAAM,OAAN,OAAcR,EAAd,KACf,IAAK,WAAY,MAAM,OAAN,OAAcC,EAAd,KACjB,IAAK,KAAM,MAAM,OAAN,OAAcC,EAAd,KACX,IAAK,OAAQ,MAAM,OAAN,OAAcC,EAAd,KACb,IAAK,QAAS,MAAM,OAAN,OAAcC,EAAd,U,wpBC5Cf,SAASQ,EAAe9C,GAA6B,IAExD+C,EAIE/C,EAJF+C,GACAC,EAGEhD,EAHFgD,MACAC,EAEEjD,EAFFiD,aACAhD,EACED,EADFC,SAGAE,EAKEC,EALFD,UACA+C,EAIE9C,EAJF8C,MACAC,EAGE/C,EAHF+C,MACAC,EAEEhD,EAFFgD,OACAC,EACEjD,EADFiD,OAZuD,EHVlBC,qBAAW1D,GGwB1CU,EAdiD,EAcjDA,SAAUa,EAduC,EAcvCA,YAAaZ,EAd0B,EAc1BA,YAd0B,EAgBpCgD,aAAS,SAACC,GAAD,OAC5B,kBAACrD,EAAD,KACE,kBAACiD,EAAD,CACET,QAAS,WAELpC,EADED,IAAayC,OACHhE,EAEAgE,KAIhB,kBAACN,EAAD,CAASG,KAAM,EAAGF,KAAMpC,IAAayC,EAAK,QAAU,SACpD,kBAACI,EAAD,KACGH,GAEH,kBAACK,EAAD,CACEV,QAAS,SAAAc,GAAC,OAAIA,EAAEC,oBAEdT,GAAgBO,GAAST,IAAOzC,EAAY2C,IAAiB,OAInE,kBAACC,EAAD,CACES,OAAQZ,IAAOzC,EACf7D,OAAQ0E,GAEPlB,OA1CkD,mBAgBlD2D,EAhBkD,UA+CzD,OAAOA,EAET,IAAMxD,EAAI,CACRD,UAAWsB,IAAOC,IAAT,KACTyB,MAAO1B,IAAOC,IAAT,KAIL0B,OAAQ3B,IAAOC,IAAT,KASN2B,OAAQ5B,IAAOC,IAAT,KAGNwB,MAAOzB,IAAOC,IAAT,KAEO,SAAA1B,GAAK,OAAIA,EAAM2D,OAAS3D,EAAMvD,OAAS,M,0BCrF9C,SAASoH,EAAgBC,GAE9B,OAAOC,sBADW,SAACC,EAAUC,GAAX,OAA+BA,EAAID,KACxBF,GAMxB,SAASI,EAAcJ,GAAuC,IAAD,EACvCD,EAAaC,GAD0B,mBAC3DE,EAD2D,KACpDG,EADoD,KAGlE,MAAO,CAACH,EADS,SAACI,GAAD,OAAkCD,GAAU,SAACH,GAAD,OAAcK,YAAQL,EAAOI,Q,ICJhFE,EAuBAC,E,wBAvBAD,O,mBAAAA,I,aAAAA,I,aAAAA,I,oCAAAA,M,cAuBAC,K,gBAAAA,E,iBAAAA,M,KAYL,I,iBCDDC,EAAS,SAAIC,GAAJ,OAA8B,sCAAIC,EAAJ,yBAAIA,EAAJ,uBAAqBD,GAChE,SAAAE,GACED,EAAQ1F,SAAQ,SAAA4F,GACd,IAAM7B,EAAK4B,EAAME,OACjBF,EAAMD,QAAQ3B,GAAd,eAAyB6B,EAAzB,CAAgC7B,OAChC4B,EAAME,iBAKNC,EAAa,SAAIL,GAAJ,OAA8B,SAAC1B,GAAD,OAAoB0B,GAAS,SAAAE,GAC5E,KAAI5B,KAAM4B,EAAMD,SAGd,MAAM,IAAI9H,MAAM,oBAFT+H,EAAMD,QAAQ3B,QAMnBgC,EAAa,SAAIN,GAAJ,OAA8B,SAAC1B,EAAgBxB,GAAjB,OAA8BkD,GAAS,SAAAE,GACtF,KAAI5B,KAAM4B,EAAMD,SAGd,MAAM,IAAI9H,MAAM,aAFhB+H,EAAMD,QAAQ3B,GAAd,eAAyBxB,EAAzB,CAAgCwB,YAM9BiC,EAAiB,SAAIP,GAAJ,OAA8B,SAAC7F,GAAD,OAAyC6F,GAAS,SAAAE,GACrGA,EAAMD,QAAUO,OAAOtI,OAAOgI,EAAMD,SACjC9F,QAAO,SAAAsG,GAAI,OAAKtG,EAAOsG,MACvBC,QAAO,SAACD,EAAME,GAAP,mBAAC,eACNF,EAAKnC,GAAKmC,GACRE,WAIHC,EAAiB,SAAIZ,GAAJ,OAA8B,SAACa,GAAD,OAA0Cb,GAAS,SAAAE,GACtGA,EAAMD,QAAUO,OAAOtI,OAAOgI,EAAMD,SACjC1H,IAAIsI,GACJH,QAAO,SAACD,EAAME,GAAP,mBAAC,eACNF,EAAKnC,GAAKmC,GACRE,WAKF,SAASG,IAAwC,IAAD,EAC3BrB,EAA+B,CACvDW,OAAQ,EACRH,QAAS,KAH0C,mBAC9Cc,EAD8C,KACvCf,EADuC,KAKrD,MAAO,CACLe,QACAd,QAASO,OAAOtI,OAAO6I,EAAMd,SAC7BF,OAAQA,EAAUC,GAClBK,WAAYA,EAAcL,GAC1BM,WAAYA,EAAcN,GAC1BO,eAAgBA,EAAkBP,GAClCY,eAAgBA,EAAkBZ,I,aCThCgB,EAAgB5F,IAAMC,mBAAkCf,GAEjD2G,EAAmB,kBAAM7F,IAAMyD,WAAWmC,IAEhD,SAASE,IACd,IAAMC,EH1ED,SAAsB9B,GAA+B,IAAD,EAChCI,EAAWJ,GADqB,mBAClDvG,EADkD,KAC7C4G,EAD6C,KAYzD,MAAO,CACL5G,MACAsI,IAXA,IAAIC,MAAM,GAAI,CACZvI,IADY,SACRwI,EAAGC,GACL,OAAO,SAACzE,GACN4C,GAAU,SAAA8B,GACRA,EAAMD,GAAKzE,UGmEL2E,CAAmB,CACjCC,MAAO7G,QAAMI,MACb0G,MAAM,EACNC,UAAW,GACXC,IAAK,CAAC,EAAG,GACTC,KAAMhC,EAASiC,OACfC,SAAUnC,EAASoC,SAPqC,EASdrG,qBATc,mBASnDsG,EATmD,KASnCC,EATmC,KAUpDC,EAActB,IACduB,EAAevB,IAoCrB,OAlBAwB,aAAiB,SAAAtD,GAAC,MAAc,MAAVA,EAAEuD,OAAa,WAC/BpB,EAAQrI,IAAIgJ,OAAShC,EAASiC,OAChCZ,EAAQC,IAAIU,KAAKhC,EAAS0C,QACjBrB,EAAQrI,IAAIgJ,OAAShC,EAAS0C,QACvCrB,EAAQC,IAAIU,KAAKhC,EAASiC,WAG9BO,aAAiB,SAAAtD,GAAC,MAAc,MAAVA,EAAEuD,OAAa,WAC/BpB,EAAQrI,IAAIkJ,WAAanC,EAASoC,OACpCd,EAAQC,IAAIY,SAASnC,EAAS4C,KACrBtB,EAAQrI,IAAIkJ,WAAanC,EAAS4C,IAC3CtB,EAAQC,IAAIY,SAASnC,EAAS6C,KACrBvB,EAAQrI,IAAIkJ,WAAanC,EAAS6C,IAC3CvB,EAAQC,IAAIY,SAASnC,EAAS8C,gBACrBxB,EAAQrI,IAAIkJ,WAAanC,EAAS8C,gBAC3CxB,EAAQC,IAAIY,SAASnC,EAASoC,WAG3B,CACLC,iBACAC,oBACAhB,UACAiB,cACAC,eACAO,iBAxCuB,SAACC,EAAcC,EAAoBC,EAAqBC,GAC/E,IAAMC,EAAUb,EAAYrB,MAAMX,OAClCgC,EAAYrC,OAAO,CACjBiD,YACAD,cACAD,aACAD,SAEFR,EAAatC,OAAb,MAAAsC,EAAY,YAAY,IAAIhK,MAAMyK,EAAaC,GAC5CzK,KAAK,GACLC,KAAI,iBAAO,CACV0K,UACA1K,IAAK,IAAIT,SAAckL,EAAWA,EAAWnI,QAAMG,cAkCpD,SAASkI,EAAqB3H,GAEnC,OACE,kBAACyF,EAAcnE,SAAf,CACEC,MAAOoE,KAEN3F,EAAMC,UChKb,IAAM2H,GAAgB,SAAC5D,EAAgB6D,GAAjB,MAA2D,mBAAdA,EAA0BA,GAAa7D,GAE7F8D,GAAY,eAACC,IAAD,gEACvBhE,qBAAkC6D,GAAeG,I,kPCCnD,IAAMC,GAAO,SAAC5L,EAAaC,GAAd,OAA8B,SAACC,GAC1C,OAAIA,EAAIF,EACCA,EACEE,EAAID,EACNA,EAEFC,IAkCF,SAAS2L,GAAWjI,GAAyB,IAAD,IAE/CvD,EAQEuD,EARFvD,OACAD,EAOEwD,EAPFxD,MACAyD,EAMED,EANFC,SACAiI,EAKElI,EALFkI,YACAC,EAIEnI,EAJFmI,aACAC,EAGEpI,EAHFoI,YACAC,EAEErI,EAFFqI,UACA1F,EACE3C,EADF2C,QAEI0D,EAAS,UAAGrG,EAAMqG,iBAAT,QAAsB,EAC/BD,EAAI,UAAGpG,EAAMoG,YAAT,SACJ5E,EAAMb,iBAAuB,MAC7B2F,EA7BD,SAA0BtG,GAAuE,IAAD,EAEnGwB,EAGExB,EAHFwB,IACA/E,EAEEuD,EAFFvD,OACAD,EACEwD,EADFxD,MAEI6J,EAAS,UAAGrG,EAAMqG,iBAAT,QAAsB,EANgE,EAOhFiC,aAAS9G,GAAtB+G,EAP6F,EAO7FA,IAAKC,EAPwF,EAOxFA,IAKb,OAJ8BpH,mBAAQ,iBAAM,CAC1C4G,GAAK,EAAGxL,EAAQ,EAAhBwL,CAAmBS,KAAKC,MAAMH,EAAMlC,IACpC2B,GAAK,EAAGvL,EAAS,EAAjBuL,CAAoBS,KAAKC,MAAMF,EAAMnC,OACpC,CAACkC,EAAKC,IAkBGG,CAAc,eAAK3I,EAAN,CAAawB,SAEpCrB,EAEEC,GAFFD,UACAyI,EACExI,GADFwI,MAEIC,EAAYzC,EAAO,CACvB0C,gBAAiB,+FACjBC,eAAe,GAAD,OAAK1C,EAAL,cAAoBA,EAApB,MACd2C,YAAa,oBACbC,aAAc,qBACZ,CACAC,OAAQ,qBAEZ,OACE,kBAAC/I,EAAD,KACE,kBAACyI,EAAD,CACEpH,IAAKA,EACLqB,MAAK,aACHrG,MAAOA,EAAQ6J,EACf8C,SAAU3M,EAAQ6J,EAClB+C,SAAU5M,EAAQ6J,EAClB5J,OAAQA,EAAS4J,EACjBgD,UAAW5M,EAAS4J,EACpBiD,UAAW7M,EAAS4J,GACjBwC,GAELX,YAAa,kBAAMA,EAAcA,EAAW,WAAX,cAAe5B,IAAO,MACvD6B,aAAc,kBAAMA,EAAeA,EAAY,WAAZ,cAAgB7B,IAAO,MAC1D+B,UAAW,kBAAMA,EAAYA,EAAS,WAAT,cAAa/B,IAAO,MACjD8B,YAAa,kBAAMA,EAAcA,EAAW,WAAX,cAAe9B,IAAO,MACvD3D,QAAS,kBAAMA,EAAUA,EAAO,WAAP,cAAW2D,IAAO,QAE5CrG,GAMP,IAAMG,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAGTkH,MAAOnH,IAAOC,IAAT,O,8KC3EA,SAAS6H,GAAOvJ,GAAqB,IAAD,QAEvCqG,EAKErG,EALFqG,UACAmD,EAIExJ,EAJFwJ,kBACAC,EAGEzJ,EAHFyJ,OACAC,EAEE1J,EAFF0J,eACAtB,EACEpI,EADFoI,YANuC,EAQfhH,mBAAQ,iBAAO,CAAE5E,MAAOiN,EAAOjN,MAAOC,OAAQgN,EAAOhN,UAAW,CAACgN,IAAnFjN,EARiC,EAQjCA,MAAOC,EAR0B,EAQ1BA,OACTgK,EAAQ,UAAGzG,EAAMyG,gBAAT,QAAqBnC,EAASoC,OAEtCN,GADO,EAAGpG,EAAM2J,QACZ,UAAG3J,EAAMoG,YAAT,UACJG,EAAI,UAAGvG,EAAMuG,YAAT,QAAiBhC,EAASiC,OAC9BL,EAAQnG,EAAMmG,OAAS7G,QAAMI,MAC7BkK,EAASjJ,iBAAiC,MAdP,EAedmH,IAAU,GAfI,mBAelC+B,EAfkC,KAe1BC,EAf0B,KAgBnCC,EAAqB3I,mBAAQ,kBAAMS,YAAaC,YAAcC,GAAQsE,GAAW1E,cACrF,CAAC0E,EAAWtE,IAEdnB,qBAAU,WAAO,IACPC,EAAY+I,EAAZ/I,QACR,GAAIA,EAAS,CACX,IAAMmJ,EAAMnJ,EAAQoJ,WAAW,MAC3BD,GACFA,EAAIE,aAAaC,YAAiBV,EAAQpD,GAAY,EAAG,MAG5D,CAACuD,EAAQH,EAAQpD,IAIpB,IAAM+D,EAAWhJ,mBAAQ,kBAAM,SAACqI,EAAuB/K,EAAYC,GACjE,OAAI8K,EAAOlM,IAAImB,EAAIC,GAAIP,GAAG+H,GACjBsD,EAEFA,EAAOxM,QAAQK,IAAIoB,EAAIC,EAAIwH,MACjC,CAACA,IAEEkE,EAAajJ,mBAAQ,kBAAM,SAACkJ,EAAYC,GAAgB,IACpD/N,EAAkBiN,EAAlBjN,MAAOC,EAAWgN,EAAXhN,OAEXqC,EAAIsL,EAASX,EAAQa,EAAIC,GACzB9D,IAAanC,EAAS4C,MAExBpI,EAAIsL,EAAStL,EAAGtC,GAAS8N,EAAK,GAAIC,IAEhC9D,IAAanC,EAAS6C,MACxBrI,EAAIsL,EAAStL,EAAGwL,EAAI7N,GAAU8N,EAAK,KAEjC9D,IAAanC,EAAS8C,iBACxBtI,EAAIsL,EAAStL,EAAGtC,GAAS8N,EAAK,GAAI7N,GAAU8N,EAAK,MAG9CzL,EAAEV,GAAGqL,IAAWC,GACnBA,EAAe5K,MAEhB,CAACsL,EAAU/D,EAAWqD,EAAgBjD,EAAUgD,IAE7Ce,EAAapJ,mBAAQ,kBAAM,SAACkJ,EAAYC,GAC5C,IAAIzL,EAAI2K,EAAOgB,SAASH,EAAIC,EAAIpE,GAE5BuD,GACFA,EAAe5K,MAChB,CAACsL,EAAU/D,EAAWqD,EAAgBD,EAAQtD,IAE7CuE,EAAOL,EAEX,OAAQ9D,GACN,KAAKhC,EAAS0C,OAAQyD,EAAOF,EAAY,MACzC,QAASE,EAAOL,EAGlB,IAAMM,EAAkBvJ,mBAAQ,kBAAM,SAAC/D,EAAWD,GAChD0M,GAAS,GAELN,GACFA,EAAkBC,EAAOxM,SAE3ByN,EAAKrN,EAAGD,MACP,CAAC0M,EAAUY,EAAMjB,EAAQD,IAEtBoB,EAAgBxJ,mBAAQ,kBAAM,WAClC0I,GAAS,MACR,IAEGe,EAAkBzJ,mBAAQ,kBAAM,SAAC/D,EAAWD,GAC5CyM,GACFa,EAAKrN,EAAGD,GAENgL,GACFA,EAAY,CAAC/K,EAAGD,OAEjB,CAACyM,EAAQa,IAGVvK,EAEEC,GAFFD,UACA2K,EACE1K,GADF0K,WAEF,OACE,kBAAC3K,EAAD,CACE0C,MAAO,CACLkI,OAAQxE,IAAShC,EAASiC,OAAlB,cAAkCjE,EAAlC,2BAAkFC,EAAlF,eAGV,kBAACyF,GAAD,cACM,CAAEzL,QAAOC,SAAQ4J,YAAWD,QADlC,CAEE8B,YAAayC,EACbxC,aAAcyC,EACdvC,UAAWuC,EACXxC,YAAayC,IAEb,kBAACC,EAAD,eACEtJ,IAAKoI,EACL/G,MAAO,CACLiG,gBAAiB1C,EAAO,OAAH,cAAmB2D,EAAnB,OAEnB,CACFvN,MAAOA,EAAQ6J,EACf5J,OAAQA,EAAS4J,OAQtB,IAiBDjG,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAGToJ,WAAYrJ,IAAOmI,OAAT,OAGL,SAASoB,GAAT,GAIH,IAHFtB,EAGC,EAHDA,eAGC,EC7KI,SAAqBuB,GAA+B,IAAD,EAChC5K,mBAAQ,OAAM4K,QAAN,IAAMA,IAAgB,IADE,mBACjDjJ,EADiD,KAC3CkJ,EAD2C,KAElDhM,EAAOkC,mBAAQ,kBAAM,SAAC9E,GAC1B4O,EAAQ,GAAD,mBAAKlJ,GAAL,CAAW1F,QACjB,CAAC0F,EAAMkJ,IACJC,EAAM/J,mBAAQ,kBAAMY,EAAKxD,OAAS,EAAIwD,EAAKA,EAAKxD,OAAS,QAAKO,IAAW,CAACiD,IAC1EoJ,EAAMhK,mBAAQ,kBAAM,WACxB8J,EAAQlJ,EAAKqJ,MAAM,EAAGrJ,EAAKxD,OAAS,OACnC,CAACwD,EAAMkJ,IAGV,MAAO,CAACC,EADO/J,mBAAQ,kBAAMY,EAAKxD,SAAQ,CAACwD,IACtB,CACnB9C,OACAkM,MACAE,MALY,kBAAMJ,EAAQ,ODqKSK,GADpC,mBACMJ,EADN,KACW3M,EADX,YACqB4M,EADrB,EACqBA,IAAKlM,EAD1B,EAC0BA,KAE3BsM,cACE,SAAAC,GAAK,MAAkB,MAAdA,EAAMzE,MAAiC,IAAlByE,EAAMC,WACpC,SAACjI,GACCA,EAAEkI,iBACFlI,EAAEC,kBACEyH,GAAOzB,GACTA,EAAeyB,GAEb3M,EAAS,GACX4M,MAED,CAAEK,MAAO,YAId,OAH8B,SAACG,GAC7B1M,EAAK0M,EAAI3O,U,cElLN,SAAS4O,GAAkB7L,GAAkD,IAAD,EACzEyJ,EAAWzJ,EAAXyJ,OACF7G,EAAI,UAAG5C,EAAM4C,YAAT,QAAiB,EACrBpB,EAAM3B,IAAMiM,YAoBlB,OAjBAlL,qBAAU,WACR,GAAIY,EAAIX,QAAS,CACf,IAAM+I,EAASpI,EAAIX,QACXrE,EAAkBiN,EAAlBjN,MAAOC,EAAWgN,EAAXhN,OACfmN,EAAOpN,MAAQA,EAAQoG,EACvBgH,EAAOnN,OAASA,EAASmG,EAEzB,IADA,IAAMoH,EAAMJ,EAAOK,WAAW,MACrB5M,EAAI,EAAGA,EAAIb,EAAOa,IACzB,IAAK,IAAID,EAAI,EAAGA,EAAIX,EAAQW,IAAK,CAC/B,IAAM2O,EAAItC,EAAOlM,IAAIF,EAAGD,GAChBmC,EAAewM,EAAfxM,EAAGC,EAAYuM,EAAZvM,EAAGV,EAASiN,EAATjN,EAAGD,EAAMkN,EAANlN,EACjBmL,EAAIgC,UAAJ,eAAwBzM,EAAxB,YAA6BC,EAA7B,YAAkCV,EAAlC,YAAuCD,EAAvC,KACAmL,EAAII,SAAS/M,EAAIuF,EAAMxF,EAAIwF,EAAMA,EAAMA,OAG5C,CAAC6G,IAGF,4BACEjI,IAAKA,EACLqB,MAAO,CACLrG,MAAOiN,EAAOjN,MAAQoG,EACtBnG,OAAQgN,EAAOhN,OAASmG,EACxBqJ,gBAAiB,OACjBnD,gBAAgB,OAAD,OAAS7G,EAAT,KACfiK,iBAAkB,SAClBnD,eAAgB,KC5BjB,SAASoD,GAAmBnM,GAAkD,IAAD,EAC1EyJ,EAAWzJ,EAAXyJ,OACF7G,EAAI,UAAG5C,EAAM4C,YAAT,QAAiB,GACrBpB,EAAM3B,IAAMiM,YA8BlB,OA7BAlL,qBAAU,WACR,GAAIY,EAAIX,QAAS,CACf,IAAMuL,EAAQ,SAACC,GAAD,OA1Bb,SAAqB5C,EAAuB4C,EAAsCzJ,GACvF,IAAM0J,EAAK,OAAG1J,QAAH,IAAGA,IAAQ,EAChBgH,EAAS2C,SAASC,cAAc,UAC9BhQ,EAAkBiN,EAAlBjN,MAAOC,EAAWgN,EAAXhN,OACfmN,EAAOpN,MAAQA,EAAQ8P,EACvB1C,EAAOnN,OAASA,EAAS6P,EAEzB,IADA,IAAMtC,EAAMJ,EAAOK,WAAW,MACrB5M,EAAI,EAAGA,EAAIb,EAAOa,IACzB,IAAK,IAAID,EAAI,EAAGA,EAAIX,EAAQW,IAAK,CAC/B,IAAM2O,EAAItC,EAAOlM,IAAIF,EAAGD,GAChBmC,EAAewM,EAAfxM,EAAGC,EAAYuM,EAAZvM,EAAGV,EAASiN,EAATjN,EAAGD,EAAMkN,EAANlN,EACjBmL,EAAIgC,UAAJ,eAAwBzM,EAAxB,YAA6BC,EAA7B,YAAkCV,EAAlC,YAAuCD,EAAvC,KACAmL,EAAII,SAAS/M,EAAIiP,EAAOlP,EAAIkP,EAAOA,EAAOA,GAK9C,OAHID,GACFrC,EAAIE,aAAamC,EAAKrC,EAAIyC,aAAa,EAAG,EAAG7C,EAAOpN,MAAOoN,EAAOnN,SAAU,EAAG,GAE1EmN,EASkD8C,CAAYjD,EAAQ4C,EAAMzJ,IACzE+J,EAAOnL,EAAIX,QACX+L,EAAS,SAAC5J,EAAeqJ,GAC7B,IAAMQ,EAAON,SAASC,cAAc,OAC9BM,EAAQP,SAASC,cAAc,QACrCM,EAAMC,YAAc/J,EACpB6J,EAAKG,YAAYF,GACjBD,EAAKG,YAAYZ,EAAMC,IACvBM,EAAKK,YAAYH,IAEnBD,EAAO,iBAAO,SAAAvP,GAAC,OAAIA,KACnBuP,EAAO,uBAAc5L,OAAOiM,IAAIC,KAAKC,OAAOC,QAC5CR,EAAO,sBAAa5L,OAAOiM,IAAIC,KAAKC,OAAOE,OAC3CT,EAAO,uBAAc5L,OAAOiM,IAAIC,KAAKC,OAAOG,QAC5CV,EAAO,0BAAiB5L,OAAOiM,IAAIC,KAAKC,OAAOI,WAC/CX,EAAO,wBAAe5L,OAAOiM,IAAIC,KAAKC,OAAOK,SAC7CZ,EAAO,sBAAa5L,OAAOiM,IAAIC,KAAKC,OAAOM,OAC3Cb,EAAO,4BAAkB,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOQ,OAAOD,EAAK,OACnEd,EAAO,oCAA0B,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOS,eAAeF,EAAK,OACnFd,EAAO,2BAAiB,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOU,MAAMH,EAAK,OACjEd,EAAO,4CAAkC,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOW,uBAAuBJ,EAAK,GAAK,GAAK,OAC7Gd,EAAO,4BAAkB,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOY,OAAOL,EAAK,OACnEd,EAAO,kCAAwB,SAAAc,GAAG,OAAI1M,OAAOiM,IAAIC,KAAKC,OAAOa,aAAaN,EAAK,GAAK,UAGrF,CAACjE,EAAQ7G,IAGV,yBACEC,MAAO,CACLoL,QAAS,OACTC,oBAAqB,kBACrBC,QAAS,IAEX3M,IAAKA,I,uzBCvDJ,SAAS4M,KAAkB,IAAD,EAM3B1I,IAJFmB,EAF6B,EAE7BA,YACAC,EAH6B,EAG7BA,aACAH,EAJ6B,EAI7BA,eACAC,EAL6B,EAK7BA,kBAGAzG,EAMEC,GANFD,UACAkO,EAKEjO,GALFiO,eACAjL,EAIEhD,GAJFgD,OACAkL,EAGElO,GAHFkO,iBACAC,EAEEnO,GAFFmO,KACAC,EACEpO,GADFoO,YAEF,OACE,kBAACrO,EAAD,KACG0G,EAAYnC,QAAQ1H,KAAI,SAAAyR,GAAU,OACjC,kBAACJ,EAAD,CAAgBrH,IAAKyH,EAAW1L,IAC9B,kBAACK,EAAD,KACE,8BAAOqL,EAAWnH,OAEpB,kBAACgH,EAAD,KACE,kBAACC,EAAD,CACE1L,MAAO,CACLqL,oBAAoB,UAAD,OAAYO,EAAWlH,WAAvB,YAAqCkH,EAAWhH,UAAhD,OACnBjL,MAAOiS,EAAWhH,UAAYgH,EAAWlH,WACzC9K,OAAQgS,EAAWhH,UAAYgH,EAAWjH,cAG3CV,EAAapC,QACX9F,QAAO,SAAA8P,GAAW,OAAIA,EAAYhH,UAAY+G,EAAW1L,MACzD/F,KAAI,SAAA0R,GACH,IAAMC,EAAiB,SAAC3O,GAAD,OACrB,yBACE2C,QAAS,kBAAMiE,EAAkB8H,EAAY3L,KAC7CF,MAAO,CACLrG,MAAOkS,EAAY1R,IAAIR,MACvBC,OAAQiS,EAAY1R,IAAIP,OACxBmS,SAAU,SACV1F,OAAQwF,EAAY3L,KAAO4D,EAAiB,iBAAmB,kBAGhE3G,EAAMC,WAGX,OAAIyO,EAAY1R,IAAIoB,GAAG,IAAI7B,SAAckS,EAAWhH,UAAWgH,EAAWhH,UAAWnI,QAAMG,OAEvF,kBAACkP,EAAD,CACE3H,IAAK0H,EAAY3L,IAEjB,kBAACyL,EAAD,OAMF,kBAACG,EAAD,CACE3H,IAAK0H,EAAY3L,IAEjB,kBAAC8I,GAAD,CACEpC,OAAQiF,EAAY1R,iBAa9C,IAAMoD,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAGT2M,eAAgB5M,IAAOC,IAAT,MAMd0B,OAAQ3B,IAAOC,IAAT,MAGN4M,iBAAkB7M,IAAOC,IAAT,MAKhB6M,KAAM9M,IAAOC,IAAT,MAGJ8M,YAAa/M,IAAOC,IAAT,KAjGK,MAqGUO,I,iJC5F5B,IAAM6B,GAAsC,CAC1CwD,KAAM,GACNG,UAAW,GACXD,YAAa,EACbD,WAAY,GAYP,SAASsH,KAAoD,IAAD,EACvChL,EAAaC,IAD0B,mBAC1DE,EAD0D,KACnDS,EADmD,KAMjE,OAAO,eACFT,EADL,CAEE8K,cALoB,SAACvH,GAAD,OAAwB9C,GAAS,SAAAT,GAAK,sBAAUA,EAAV,CAAiBuD,mBAM3EwH,eALqB,SAACvH,GAAD,OAAyB/C,GAAS,SAAAT,GAAK,sBAAUA,EAAV,CAAiBwD,oBAM7EwH,aALmB,SAACvH,GAAD,OAAuBhD,GAAS,SAAAT,GAAK,sBAAUA,EAAV,CAAiByD,kBAMzEwH,QATc,SAAC3H,GAAD,OAAkB7C,GAAS,SAAAT,GAAK,sBAAUA,EAAV,CAAiBsD,eAa5D,SAAS4H,GAAwBlP,GAAkC,IAEtEyH,EAQEzH,EARFyH,UACAD,EAOExH,EAPFwH,YACAD,EAMEvH,EANFuH,WACAD,EAKEtH,EALFsH,KACA0H,EAIEhP,EAJFgP,aACAD,EAGE/O,EAHF+O,eACAD,EAEE9O,EAFF8O,cACAG,EACEjP,EADFiP,QAGA9O,EACEC,GADFD,UAEF,OACE,kBAACA,EAAD,KACE,kBAAC,KAAD,KACE,kBAAC,KAAKgP,KAAN,CAAWrC,MAAO,gBAChB,kBAAC,KAAD,CAAOvL,MAAO+F,EAAM8H,SAAU,SAAA3L,GAAC,OAAIwL,EAAQxL,EAAE4L,OAAO9N,WAEtD,kBAAC,KAAK4N,KAAN,CAAWrC,MAAO,kCAChB,kBAAC,KAAD,CACE1Q,IAAK,EACLC,IAAK,EACLkF,MAAOgG,EACP6H,SAAUN,IAEZ,kBAAC,KAAD,CACE1S,IAAK,EACLC,IAAK,EACLkF,MAAOiG,EACP4H,SAAUL,KAGd,kBAAC,KAAKI,KAAN,CAAWrC,MAAO,4BAChB,kBAAC,KAAD,CAAavL,MAAOkG,EAAW2H,SAAUJ,OAMnD,IAAM5O,GAAI,CACRD,UAAWsB,IAAOC,IAAT,O,uEC9EJ,SAAS4N,KAAyB,IAAD,EACVxH,cAAU,GADA,mBAC/ByH,EAD+B,KACpBC,EADoB,KAGpCnI,EACE3B,IADF2B,iBAEIoI,EAA2BZ,KAE/B1O,EACEC,GADFD,UAEF,OACE,kBAACA,EAAD,KACE,kBAAC2C,EAAD,CACEC,GAAG,wBACHC,MAAM,qBACNC,aAAc,kBACZ,kBAACR,EAAD,CACEC,KAAM,WACNE,KAAM,GACND,QAAS,WACP6M,GAAO,QAKb,kBAACpB,GAAD,OAEF,kBAAC,KAAD,CACEsB,QAASH,EACTI,SAAUH,EACVxM,MAAM,iCACN4M,KAAM,WAAO,IAETtI,EAIEmI,EAJFnI,KACAC,EAGEkI,EAHFlI,WACAC,EAEEiI,EAFFjI,YACAC,EACEgI,EADFhI,UAEFJ,EAAiB,GAAD,OACXC,EADW,aACFC,EADE,YACYC,EADZ,KAEdD,EACAC,EACAC,GAEF+H,IACAC,EAAyBR,QAAQ,MAGnC,kBAACC,GAA4BO,KAMrCH,GAAsBvM,GAAK,wBAC3B,IAAM3C,GAAI,CACRD,UAAWsB,IAAOC,IAAT,O,+lBC/CJ,SAASmO,GAAQ7P,GAAsB,IAAD,EAEzCmG,EAEEnG,EAFFmG,MACA2J,EACE9P,EADF8P,cAEIlN,EAAI,UAAG5C,EAAM4C,YAAT,QAAiB,GACrBmN,EAAmB,CACvB,IAAIzQ,QAAM,EAAG,EAAG,EAAG,GACnB,IAAIA,QAAM,EAAG,EAAG,EAAG,GACnB,IAAIA,QAAM,IAAK,IAAK,IAAK,GACzB,IAAIA,QAAM,IAAK,EAAG,EAAG,GACrB,IAAIA,QAAM,EAAG,EAAG,IAAK,GACrB,IAAIA,QAAM,EAAG,IAAK,EAAG,GACrB,IAAIA,QAAM,IAAK,GAAI,GAAI,GACvB,IAAIA,QAAM,GAAI,IAAK,GAAI,GACvB,IAAIA,QAAM,GAAI,IAAK,GAAI,GACvB,IAAIA,QAAM,GAAI,GAAI,IAAK,IAGzBsB,qBAAU,kBAAMkP,EAAcC,EAAiB,GAAG9S,WAAU,IAnBjB,MAqBT+S,aAAeD,GArBN,mBAqBpCE,EArBoC,KAqBvBC,EArBuB,KAqBvBA,SACdC,EAAmB/O,mBAAQ,WAC/B,OAAyB,IAArB6O,EAAUzR,aAA0BO,IAAVoH,OAC5B,EAEO8J,EAAUG,WAAU,SAAArE,GAAC,OAAIA,GAAK5F,EAAM/H,GAAG2N,QAE/C,CAACkE,EAAW9J,IAETkK,EAAgBjP,mBAAQ,kBAAM,SAACkP,GAAD,OAAiB,WACnD,GAAIL,EAAUK,GAAM,CAClB,GAAIA,IAAQH,EACV,OAEAL,EAAcG,EAAUK,SAG3B,CAACL,EAAWE,IAETI,EAAUnP,mBAAQ,kBAAM,SAACqC,GACf,MAAVA,EAAEuD,IACJqJ,EAAc,EAAdA,GAEAA,GAAe5M,EAAEuD,IAAM,EAAvBqJ,MAED,CAACA,IA9CuC,EAgDNG,cAAY,SAAA/M,GAAC,MAAc,MAAVA,EAAEuD,KAAyB,SAAVvD,EAAEuD,OAAlEyJ,EAhDoC,oBAiD3C1J,aAAiB,SAAAtD,GAAC,MAAI,aAAaiN,MAAM,IAAIC,SAASlN,EAAEuD,OAAMuJ,GAjDnB,IAoDzCpQ,EAIEC,GAJFD,UACAyQ,EAGExQ,GAHFwQ,WACAC,EAEEzQ,GAFFyQ,oBACAC,EACE1Q,GADF0Q,YAEF,OACE,kBAAC3Q,EAAD,CACE0C,MAAO,CACLqL,oBAAoB,aAAD,OAAetL,EAAf,SAGpBqN,EAAUjT,KAAI,SAAC+T,EAAIT,GAAL,OACb,kBAACO,EAAD,CACE7J,IAAKsJ,EACL3N,QAAS0N,EAAcC,GACvBzN,MAAO,CACLrG,MAAOoG,IAGT,kBAACgO,EAAD,CACE5J,IAAKsJ,EACLnK,MAAO4K,EAAKA,EAAGC,UAAOjS,EACtB8D,MAAO,CACLrG,MAAOoG,EACPnG,OAAQmG,KAGZ,kBAACkO,EAAD,CAAa/N,GAAG,MAAMkO,OAAQX,IAAQH,IAAoBG,EAAM,GAAK,QAIvEG,EACE,yBACE5N,MAAO,CACLqO,SAAU,WACV/F,IAAK,oBACLgG,KAAM,oBACNC,OAAQ,MAGV,kBAAC,gBAAD,CACEjL,MAAO8J,EAAUE,GACjBf,SAAU,SAAAiC,GAAQ,IAAD,EACQA,EAAIC,IAAnB/R,EADO,EACPA,EAAGC,EADI,EACJA,EAAGV,EADC,EACDA,EAAGD,EADF,EACEA,EACjBqR,EAASC,EAAkB,IAAI7Q,QAAMC,EAAGC,EAAGV,EAAGD,IAC9CiR,EAAc,IAAIxQ,QAAMC,EAAGC,EAAGV,EAAGD,QAIrC,MAMZ,IAAMuB,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAGTkP,WAAYnP,IAAOC,IAAT,MACY,SAAA1B,GAAK,uBAAIA,EAAMmG,aAAV,QAAmB,UAE9C0K,oBAAqBpP,IAAOC,IAAT,MAQnBoP,YAAarP,IAAOC,IAAT,MAEM,SAAA1B,GAAK,OAAIA,EAAMiR,OAAS,MAAQ,SACrC,SAAAjR,GAAK,OAAIA,EAAMiR,OAAS,gBAAkB,W,i7BCzHjD,SAASM,KAAW,IAEvBpR,EAEEC,GAFFD,UACAqR,EACEpR,GADFoR,YAHsB,EASpB9L,IAHFE,EANsB,EAMtBA,QACAkB,EAPsB,EAOtBA,aACAH,EARsB,EAQtBA,eARsB,EAUMtG,oBAAkB,GAVxB,mBAUjBqP,EAViB,KAUR+B,EAVQ,KAWlBC,EAA8B1G,GAAQ,CAC1CtB,eAAgB,SAAA1M,GAAG,OAAI8J,EAAa/B,WAAW4B,EAAxB,eAClBG,EAAatB,MAAMd,QAAQiC,GADT,CAErB3J,YAdoB,EAiBN2U,eAjBM,mBAiBdC,GAjBc,WAkBxB,OACE,kBAACzR,EAAD,KACE,kBAACqR,EAAD,KACE,kBAAC,KAAD,CAAQ5O,KAAK,QAAQF,KAAK,UAAUC,QAAS,WAC3C,IAAMkP,EAAe/K,EAAatB,MAAMd,QAAQiC,GAChD+K,EAA4BG,EAAa7U,KACzC8J,EAAa/B,WACX4B,EADF,eAGOkL,EAHP,CAII7U,IAAK6U,EAAa7U,IAAID,KAAKuC,QAAMG,WAPvC,iBAWF,kBAAC+R,EAAD,KACE,kBAAC,WAAMM,MAAP,CAAalP,KAAK,QAAQrB,MAAOqE,EAAQrI,IAAIgJ,KAAM6I,SAAU,SAAA3L,GAAC,OAAImC,EAAQC,IAAIU,KAAK9C,EAAE4L,OAAO9N,QAAQwQ,YAAY,SAC9G,kBAAC,WAAMC,OAAP,CAAczQ,MAAOgD,EAASiC,QAA9B,gBACA,kBAAC,WAAMwL,OAAP,CAAczQ,MAAOgD,EAAS0C,QAA9B,wBAGJ,kBAACuK,EAAD,KACE,kBAAC3B,GAAD,CACEjN,KAAM,GACNuD,MAAOP,EAAQrI,IAAI4I,MACnB2J,cAAelK,EAAQC,IAAIM,SAG/B,kBAACqL,EAAD,KACE,kBAAC,WAAMM,MAAP,CAAalP,KAAK,QAAQrB,MAAOqE,EAAQrI,IAAIkJ,SAAU2I,SAAU,SAAA3L,GAAC,OAAImC,EAAQC,IAAIY,SAAShD,EAAE4L,OAAO9N,QAAQwQ,YAAY,SACtH,kBAAC,WAAMC,OAAP,CAAczQ,MAAO+C,EAASoC,QAA9B,UACA,kBAAC,WAAMsL,OAAP,CAAczQ,MAAO+C,EAAS4C,KAA9B,gBACA,kBAAC,WAAM8K,OAAP,CAAczQ,MAAO+C,EAAS6C,KAA9B,gBACA,kBAAC,WAAM6K,OAAP,CAAczQ,MAAO+C,EAAS8C,gBAA9B,kBAIJ,kBAACoK,EAAD,KACE,8BAAM,uBAAGS,KAAK,IAAItP,QAAS,kBAAM8O,GAAW,KAAtC,kBAKR,kBAAC,KAAD,CACEjV,MAAM,MACNkT,QAASA,EACT1M,MAAM,eACN2M,SAAU,kBAAM8B,GAAW,IAC3BS,OAAQ,MAEPxC,GACC,6BACE,kBAACvD,GAAD,CACE1C,OAAQ3C,EAAatB,MAAMd,QAAQiC,GAAgB3J,IACnD4F,KAAM,KAER,sCAAW,uBAAGqP,KAAK,IAAItP,QAAS,WAC9BiP,EAAKO,KAAKC,UAAUC,YAAcvL,EAAatB,MAAMd,QAAQiC,GAAgB3J,KAAM,KAAM,IACzFsV,KAAQC,QAAQ,8BAFP,iBAIX,yBACE1P,MAAO,CACL+L,SAAU,OACV3C,gBAAiB,OACjB9F,MAAO,SAGT,6BACGgM,KAAKC,UAAUC,YAAcvL,EAAatB,MAAMd,QAAQiC,GAAgB3J,KAAM,KAAM,QASrG,IAAMoD,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAkBT8P,YAAa/P,IAAOC,IAAT,O,yKChHN,SAAS8Q,KAAe,IAAD,EAKxB9M,IAHFiB,EAF0B,EAE1BA,eACAf,EAH0B,EAG1BA,QACAkB,EAJ0B,EAI1BA,aAGA3G,EAEEC,GAFFD,UACAsS,EACErS,GADFqS,gBAEIf,EAA8B1G,GAAQ,CAC1CtB,eAAgB,SAAA1M,GAAG,OAAI8J,EAAa/B,WAAW4B,EAAxB,eAClBG,EAAatB,MAAMd,QAAQiC,GADT,CAErB3J,YAGJ,OACE,kBAACmD,EAAD,KACE,kBAACoR,GAAD,MACA,kBAACkB,EAAD,KACE,kBAAClJ,GAAD,CACEE,OAAQ3C,EAAatB,MAAMd,QAAQiC,GAAgB3J,IACnD0M,eAAgB,SAAA1M,GAAG,OAAI8J,EAAa/B,WAAW4B,EAAxB,eAClBG,EAAatB,MAAMd,QAAQiC,GADT,CAErB3J,UAEFqJ,UAAWT,EAAQrI,IAAI8I,UACvBF,MAAOP,EAAQrI,IAAI4I,MACnBqD,kBAAmBkI,EACnBtL,KAAMR,EAAQrI,IAAI6I,KAClBK,SAAUb,EAAQrI,IAAIkJ,SACtBF,KAAMX,EAAQrI,IAAIgJ,SAO5B,IAAMnG,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAET+Q,gBAAiBhR,IAAOC,IAAT,O,+SCrDV,SAASgR,KAAe,IAAD,EAKxBhN,IAFFiB,GAH0B,EAE1Bf,QAF0B,EAG1Be,gBAIAxG,GAP0B,EAI1ByG,kBAMExG,GAHFD,WACAwS,EAEEvS,GAFFuS,iBACAC,EACExS,GADFwS,OAEF,OACE,kBAACzS,EAAD,KACE,kBAACwS,EAAD,KACE,kBAAC5S,EAAD,CAAWG,cAAeoP,GAAsBvM,IAC9C,kBAACuM,GAAD,MACA,kBAACxM,EAAD,CAAgBC,GAAG,MAAMC,MAAM,+BAGnC,kBAAC4P,EAAD,UACsB7T,IAAnB4H,EAA+B,KAC9B,kBAAC6L,GAAD,QAMV,IAAMpS,GAAI,CACRD,UAAWsB,IAAOC,IAAT,MAITiR,iBAAkBlR,IAAOC,IAAT,MAEhBkR,OAAQnR,IAAOC,IAAT,OCzCO,4BACb,kBAACiG,EAAD,KACE,kBAAC+K,GAAD,S,6MCDG,SAAS7Q,EAAa4H,GAA8D,IAAvC7G,EAAsC,uDAAvB,GAC3DgH,EAAS2C,SAASC,cAAc,UAC9BhQ,EAAkBiN,EAAlBjN,MAAOC,EAAWgN,EAAXhN,OACfmN,EAAOpN,MAAQA,EAAQoG,EACvBgH,EAAOnN,OAASA,EAASmG,EAEzB,IADA,IAAMoH,EAAMJ,EAAOK,WAAW,MACrB5M,EAAI,EAAGA,EAAIb,EAAOa,IACzB,IAAK,IAAID,EAAI,EAAGA,EAAIX,EAAQW,IAAK,CAC/B,IAAM2O,EAAItC,EAAOlM,IAAIF,EAAGD,GAChBmC,EAAewM,EAAfxM,EAAGC,EAAYuM,EAAZvM,EAAGV,EAASiN,EAATjN,EAAGD,EAAMkN,EAANlN,EACjBmL,EAAIgC,UAAJ,eAAwBzM,EAAxB,YAA6BC,EAA7B,YAAkCV,EAAlC,YAAuCD,EAAvC,KACAmL,EAAII,SAAS/M,EAAIuF,EAAMxF,EAAIwF,EAAMA,EAAMA,GAE3C,OAAOgH,EAiEF,IAAMyI,EAAgB,SAAC5I,GAAD,MA1BpB,CACLjN,OAF6BqW,EAX1B,SAAoBpJ,GAGzB,IAH4D,IACpDjN,EAAkBiN,EAAlBjN,MAAOC,EAAWgN,EAAXhN,OACTuF,EAAO,IAAI8Q,kBAAkBtW,EAAQC,EAAS,GAC3CY,EAAI,EAAGA,EAAIb,EAAOa,IACzB,IAAK,IAAID,EAAI,EAAGA,EAAIX,EAAQW,IAAK,CAAC,IAAD,EACRqM,EAAOlM,IAAIF,EAAGD,GAA7BmC,EADuB,EACvBA,EAAGC,EADoB,EACpBA,EAAGV,EADiB,EACjBA,EAAGD,EADc,EACdA,EACjBmD,EAAK6D,IAAI,CAACtG,EAAGC,EAAGV,EAAG2J,KAAKC,MAAM,IAAM7J,IAAuB,GAAjBxB,EAAIb,EAAQY,IAE1D,OAAO,IAAI2V,UAAU/Q,EAAMxF,EAAOC,GA8BqCuW,CAAWvJ,IAzB/DjN,MACjBC,OAAQoW,EAAUpW,OAClBuF,KAAM,IAAIiR,EAAOJ,EAAU7Q,KAAKkR,QAAQC,SAAS,WAJ9C,IAA0BN,GAiCpB/Q,EAAgB,SAACF,GAAD,OArBtB,SAA0BI,GAG/B,IAHgE,IACxDxF,EAAkBwF,EAAlBxF,MAAOC,EAAWuF,EAAXvF,OACTU,EAAI,IAAIZ,SAAcC,EAAOC,EAAQ6C,QAAMG,MACxCpC,EAAI,EAAGA,EAAIb,EAAOa,IACzB,IAAK,IAAID,EAAI,EAAGA,EAAIX,EAAQW,IAAK,CAAC,IAAD,EACVN,MAAMsW,KAAKpR,EAAKA,KAAKqJ,MAAwB,GAAjBhO,EAAIb,EAAQY,GAA8B,GAArBC,EAAIb,EAAQY,EAAI,KADvD,mBACxBmC,EADwB,KACrBC,EADqB,KAClBV,EADkB,KACfD,EADe,KAE/B1B,EAAEG,IAAID,EAAGD,EAAG,IAAIkC,QAAMC,EAAGC,EAAGV,EAAGD,EAAI,MAEvC,OAAO1B,EAakCkW,EAzBVrR,EAyB4CJ,EAxBpE,IAAImR,UAAU,IAAID,kBAAkB,IAAIG,EAAOjR,EAAKA,KAAM,WAAYA,EAAKxF,MAAOwF,EAAKvF,UADzF,IAA0BuF,GA4B1B,SAASmI,EAAiBV,GAAsD,IAA/B7G,EAA8B,uDAAf,GACrE,OAAOf,EAAa4H,EAAQ7G,GAAMqH,WAAW,MAAMwC,aAAa,EAAG,EAAGhD,EAAOjN,MAAQoG,EAAM6G,EAAOhN,OAASmG,M","file":"static/js/4.97078523.chunk.js","sourcesContent":["import { ValueObject } from \"./ValueObject\";\n\nconst clamp = (min: number, max: number) => (v: number) => {\n  if (v < min) {\n    return min;\n  } else if (v > max) {\n    return max;\n  } else {\n    return v;\n  }\n}\n\nexport interface DiffResult<T extends ValueObject<T>> {\n  diff: { x: number, y: number, v: T }[]\n}\n\nexport class BitMap<T extends ValueObject<T>> implements ValueObject {\n\n  public values: T[];\n\n  constructor(\n    public readonly width: number,\n    public readonly height: number,\n    fv: T\n  ) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(`非法的宽高`);\n    }\n    this.values = new Array(width * height).fill(0).map(() => fv.clone() as T);\n  }\n\n  /**\n   * 填充并返回一个新的bitMap\n   * @param v 被填充的值\n   * @pure 这是一个纯函数\n   */\n  fill(v: T): BitMap<T> {\n    return new BitMap(this.width, this.height, v.clone());\n  }\n\n  /**\n   * 更新bitmap的宽高并返回一个新的bitmap\n   * @param fillValue 填充的值\n   * @param width 新的宽度\n   * @param height 新的高度\n   * @pure 这是一个纯函数\n   */\n  updateSize(fillValue: T, width: number = this.width, height: number = this.height): BitMap<T> {\n    if (width === this.width && height === this.height) {\n      return this.clone();\n    }\n    const m = new BitMap<T>(width, height, fillValue);\n    for (let y = 0; y < this.height; y++)\n      for (let x = 0; x < this.width; x++) {\n        if (x < m.width && y < m.height) {\n          m.put(x, y, this.get(x, y))\n        }\n      }\n    return m;\n  }\n\n\n  /**\n   * \n   * @param x \n   * @param y \n   * @pure 这是一个纯函数\n   */\n  get(x: number, y: number): T {\n    if (x >= 0 && y >= 0 && x < this.width && y < this.height) {\n      // if (this.values[x * this.width + y] === undefined) {\n      //   console.log(x * this.width + y)\n      //   console.log(this.values.length)\n      //   throw new Error(`undefined 的value:${x},${y},${this.values.length},${this.width},${this.height}}`)\n      // }\n      return this.values[y * this.width + x].clone() as T;\n    } else {\n      throw Error(`x:${x},y:${y} 越BitMap下标`);\n    }\n  }\n\n  /**\n   * \n   * @param x \n   * @param y \n   * @param v \n   * @IO 这是一个IO函数\n   */\n  put(x: number, y: number, v: T): BitMap<T> {\n    if (x >= 0 && y >= 0 && x < this.width && y < this.height) {\n      this.values[y * this.width + x] = v.clone() as T;\n      return this;\n    } else {\n      throw Error(`x:${x},y:${y} 越BitMap下标`);\n    }\n  }\n\n  /**\n   * 返回一个新的，被填充了矩形填充物的，BitMap\n   * @param x0 矩形\n   * @param y0 矩形\n   * @param x1 矩形\n   * @param y1 矩形\n   * @param v 填充物\n   * @Pure 这是一个纯函数\n   */\n  fillRect(x0: number, y0: number, x1: number, y1: number, v: T): BitMap<T> {\n    if (x0 > x1 || y0 > y1) {\n      throw new Error(\"不支持坐标反向\");\n    }\n    const self = this.clone();\n    const cwl = clamp(0, self.width);\n    const chl = clamp(0, self.height);\n    const [sx, sy, ex, ey] = [cwl(x0), chl(y0), cwl(x1), chl(y1)];\n    for (let x = sx; x < ex; x++)\n      for (let y = sy; y < ey; y++) {\n        self.put(x, y, v);\n      }\n    return self;\n  }\n\n  /**\n   * 填充封闭区域\n   * @param x \n   * @param y \n   * @param v \n   * @Pure 这是一个纯函数\n   */\n  fillArea(x: number, y: number, fitV: T): BitMap<T> {\n    const self = this.clone();\n    // 初始化\n    const aimC = self.get(x, y);\n    if (aimC.eq(fitV)) {\n      return self;\n    }\n    const queue = [[x, y]];\n    const vist = {\n      [[x, y].join(',')]: true\n    };\n    // 广度优先遍历\n    while (queue.length > 0) {\n      const p = queue.shift();\n      const [_x, _y] = p!;\n      if (self.get(_x, _y).eq(fitV)) {\n        continue;\n      } else {\n        self.put(_x, _y, fitV)\n      }\n      const willPoints = [\n        [_x, _y + 1],\n        [_x + 1, _y],\n        [_x, _y - 1],\n        [_x - 1, _y]\n      ]\n        .filter(([a, b]) =>\n          a >= 0\n          && b >= 0\n          && a < self.width\n          && b < self.height\n          && self.get(a, b).eq(aimC)\n          && vist[[a, b].join(',')] === undefined\n        );\n      willPoints\n        .forEach(pit => {\n          // const [_x, _y] = pit;\n          // self.put(_x, _y, fitV);\n          vist[pit.join(',')] = true;\n          queue.push(pit);\n        });\n    }\n    // 返回一个新的\n    return self;\n  }\n\n  diff(v: BitMap<T>): DiffResult<T> {\n    if (!this.shapeEq(v)) {\n      throw new Error('shape不同的bitMap无法diff');\n    }\n    const result: DiffResult<T> = { diff: [] };\n    for (let x = 0; x < this.width; x++)\n      for (let y = 0; y < this.height; y++) {\n        if (!this.get(x, y).eq(v.get(x, y))) {\n          result.diff.push({ x, y, v: this.get(x, y).clone() });\n        }\n      }\n    return result;\n  }\n\n  private shapeEq(v: BitMap<T>): boolean {\n    return v.width === this.width && v.height === this.height\n  }\n\n  /**\n   * \n   * @param v \n   * @Pure 这是一个纯函数\n   */\n  eq(v: BitMap<T>): boolean {\n    if (!this.shapeEq(v)) {\n      return false;\n    }\n    for (let x = 0; x < this.width; x++)\n      for (let y = 0; y < this.height; y++) {\n        if (!this.get(x, y).eq(v.get(x, y))) {\n          return false;\n        }\n      }\n    return true;\n  }\n\n  /**\n   * @Pure 这是一个纯函数\n   */\n  clone(): BitMap<T> {\n    const m = new BitMap<T>(this.width, this.height, this.values[0])\n    for (let x = 0; x < this.width; x++)\n      for (let y = 0; y < this.height; y++) {\n        m.put(x, y, this.get(x, y))\n      }\n    return m;\n  }\n}","import { ValueObject } from \"./ValueObject\";\n\nexport class Color implements ValueObject {\n\n  constructor(\n    public readonly r: number,\n    public readonly g: number,\n    public readonly b: number,\n    public readonly a: number = 1,\n  ) { }\n\n  public static none: Color = new Color(0, 0, 0, 0);\n  public static black: Color = new Color(0, 0, 0);\n  public static white: Color = new Color(255, 255, 255, 1);\n\n\n  get rgba(): string {\n    const { r, g, b, a } = this;\n    return `rgba(${r},${g},${b},${a})`;\n  }\n\n  eq(v: Color): boolean {\n    const { r, g, b, a } = this;\n    return r === v.r && g === v.g && b === v.b && a === v.a;\n  }\n\n  clone(): Color {\n    return new Color(this.r, this.g, this.b, this.a);\n  }\n\n}","export * from './BitMap';\nexport * from './ValueObject';\nexport * from './Color';","import React, { useContext, useState, useRef, useEffect, useMemo } from 'react';\nimport styled from '@emotion/styled';\nimport { ID } from '@/src/hooks/types'\n\nconst AccordionContext = React.createContext<{\n  fullHeight: number;\n  panelHeight: number;\n  activeID: ID;\n  setActiveID: (id: ID) => void;\n}>(undefined);\n\nexport const useAccordionContext = () => useContext(AccordionContext);\n\nexport interface AccordionProps extends AccordionState {\n  children?: React.ReactChild | React.ReactChild[];\n  defaultActive?: ID,\n}\n\nexport interface AccordionState {\n}\nexport function useAccordion(): AccordionState {\n  return {} as AccordionState;\n}\n\nexport function Accordion(props: AccordionProps) {\n  const {\n    children,\n    defaultActive\n  } = props;\n  const {\n    Container\n  } = S;\n  const [activeID, setActiveID] = useState<ID>(defaultActive);\n  const [fullHeight, setFullHeight] = useState<number>(0);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (containerRef.current.offsetHeight) {\n      setFullHeight(containerRef.current.offsetHeight);\n      const resize = () => setFullHeight(containerRef.current.offsetHeight);\n      window.addEventListener(\"resize\", resize);\n      return () => window.removeEventListener('resize', resize);\n    }\n  }, [containerRef]);\n  const panelHeight = useMemo(\n    () => Array.isArray(children) ? fullHeight - 22 * children.length : fullHeight - 22,\n    [fullHeight, children]\n  )\n  return (\n    <AccordionContext.Provider value={{ activeID, fullHeight, panelHeight, setActiveID }}>\n      <Container ref={containerRef}>\n        {children}\n      </Container>\n    </AccordionContext.Provider>\n  );\n}\nconst S = {\n  Container: styled.div`\n    height: 100vh;\n    background-color: #000;\n    color: #fff;\n  `,\n}\n","import { Bin } from \"./canvas/types\";\nimport { bitMap2Image, base642BitMap } from \"./canvas/utils\";\n\nexport const toDataURL = (bin: Bin) => bitMap2Image(base642BitMap(bin), 1).toDataURL();\n\n/**\n * 黑白纹理\n */\nexport const BW2x2: Bin = {\n  height: 2,\n  width: 2,\n  data: 'kJCQ////////////kJCQ/w=='\n};\n\nexport const BW2x2_DATA_URL = toDataURL(BW2x2);\n\n/**\n * 图标: 尺寸重定义\n */\nexport const ICON_RESIZE32x32: Bin = {\n  \"width\": 32,\n  \"height\": 32,\n  \"data\": \"AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/w==\"\n};\n\nexport const ICON_RESIZE32x32_DATA_URL = toDataURL(ICON_RESIZE32x32)\n\n/**\n * 图标: 添加文件\n */\nexport const ICON_ADD_FILE22x22: Bin = {\n  \"width\": 22,\n  \"height\": 22,\n  \"data\": \"AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////////////////////////////////////AAAA/wAAAP//////////////////////////////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAP8AAAD/AAAA//////8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAD/AAAA/wAAAP//////AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAAAAAAA/wAAAP8AAAD//////wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAD/AAAA/wAAAP8AAAD//////////////////////////////////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAAAAAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////////////////////////////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/w==\"\n};\n\nexport const ICON_ADD_FILE22x22_DATA_URL = toDataURL(ICON_ADD_FILE22x22);\n\n/**\n * 图标: 上\n */\nexport const ICON_UP16x16: Bin = {\n  \"width\": 16,\n  \"height\": 16,\n  \"data\": \"AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/////////////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////w==\"\n};\n\nexport const ICON_UP16x16_DATA_URL = toDataURL(ICON_UP16x16);\n\n/**\n * 图标: 下\n */\nexport const ICON_DOWN16x16: Bin = {\n  \"width\": 16,\n  \"height\": 16,\n  \"data\": \"////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////////////////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/w==\"\n};\n\nexport const ICON_DOWN16x16_DATA_URL = toDataURL(ICON_DOWN16x16);\n\n/**\n * 图标: 右\n */\nexport const ICON_RIGHT16x16: Bin = {\n  \"width\": 16,\n  \"height\": 16,\n  \"data\": \"/////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP///////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD//////////////////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/w==\"\n};\n\nexport const ICON_RIGHT16x16_DATA_URL = toDataURL(ICON_RIGHT16x16);\n\n/**\n * 光标: 铅笔\n */\nexport const CURSOR_PANCEL32x32: Bin = {\n  \"width\": 32,\n  \"height\": 32,\n  \"data\": \"AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/wAAAP8AAAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/viA2/74gNv8AAAD/AAAA//8AAP//AAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/74gNv++IDb/AAAA/wAAAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv++IDb/viA2/wAAAP8AAAD//wAA//8AAP//AAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/viA2/74gNv8AAAD/AAAA//8AAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP++IDb/AAAA/wAAAP//AAD//wAA//8AAP//AAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD//wAA//8AAP//AAD//wAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAA==\"\n}\n\nexport const CURSOR_PANCEL32x32_DATA_URL = toDataURL(CURSOR_PANCEL32x32);\n\n/**\n * 光标: 油漆桶\n */\nexport const CURSOR_BUCKET32x32: Bin = {\n  \"width\": 32,\n  \"height\": 32,\n  \"data\": \"AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAAAAAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAAAAAAD/AAAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAAAAAAAP8AAAAAAAAA/wAAAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAAAAAAAAD/AAAAAAAAAP8AAAAAAAAA//8AAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD/AAAAAAAAAP8AAAD//wAA//8AAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD/AAAAAAAAAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD/AAAA//8AAP//AAD//wAA//8AAP//AAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD//wAA//8AAP//AAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA/wAAAP//AAD//wAA//8AAP//AAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAA//8AAP//AAD//wAA/wAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAD//wAA//8AAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\"\n}\n\nexport const CURSOR_BUCKET32x32_DATA_URL = toDataURL(CURSOR_BUCKET32x32);","import React from 'react';\nimport styled from '@emotion/styled';\nimport {\n  ICON_RESIZE32x32_DATA_URL,\n  ICON_ADD_FILE22x22_DATA_URL,\n  ICON_DOWN16x16_DATA_URL,\n  ICON_UP16x16_DATA_URL,\n  ICON_RIGHT16x16_DATA_URL\n} from '../bins';\n\nexport type BinIconType =\n  | \"resize\"\n  | \"add_file\"\n  | \"up\"\n  | \"down\"\n  | \"right\"\n\nexport interface BinIconProps extends BinIconState {\n  type: BinIconType;\n  size?: number;\n  onClick?: () => void;\n}\n\nexport interface BinIconState {\n\n}\nexport function useBinIcon(): BinIconState {\n  return {} as BinIconState;\n}\n\nexport function BinIcon(props: BinIconProps) {\n  const {\n    type,\n    onClick,\n  } = props;\n  const size = props.size ?? 32;\n  const {\n    Container\n  } = S;\n  return (\n    <Container\n      type={type}\n      style={{\n        width: size,\n        height: size,\n      }}\n      onClick={() => {\n        if (onClick) {\n          onClick();\n        }\n      }}\n    >\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div<{ type: BinIconType }>`\n    display: inline-block;\n    vertical-align: middle;\n    background-image: ${props => {\n      switch (props.type) {\n        case \"resize\": return `url(${ICON_RESIZE32x32_DATA_URL})`;\n        case \"add_file\": return `url(${ICON_ADD_FILE22x22_DATA_URL})`;\n        case \"up\": return `url(${ICON_UP16x16_DATA_URL})`;\n        case \"down\": return `url(${ICON_DOWN16x16_DATA_URL})`;\n        case \"right\": return `url(${ICON_RIGHT16x16_DATA_URL})`;\n      }\n    }};\n    background-size: 100%;\n  `,\n}\n","import React, { useMemo, useEffect } from 'react';\nimport styled from '@emotion/styled';\nimport { useMount, useHover } from 'react-use';\nimport { useAccordionContext } from './Accordion';\nimport { ID } from '@/src/hooks/types';\nimport { BinIcon } from '../icon/BinIcon';\n\nexport interface AccordionPanelProps extends AccordionPanelState {\n  id: ID,\n  title: string;\n  actionRender?: () => React.ReactElement;\n  children?: React.ReactChild;\n}\n\nexport interface AccordionPanelState {\n\n}\nexport function useAccordionPanel(): AccordionPanelState {\n  return {} as AccordionPanelState;\n}\n\nexport function AccordionPanel(props: AccordionPanelProps) {\n  const {\n    id,\n    title,\n    actionRender,\n    children,\n  } = props;\n  const {\n    Container,\n    Panel,\n    Title,\n    Header,\n    Action,\n  } = S;\n  const { activeID, panelHeight, setActiveID } = useAccordionContext();\n\n  const [el, hoverd] = useHover((hoved) => (\n    <Container>\n      <Header\n        onClick={() => {\n          if (activeID === id) {\n            setActiveID(undefined);\n          } else {\n            setActiveID(id);\n          }\n        }}\n      >\n        <BinIcon size={8} type={activeID === id ? \"right\" : \"down\"} />\n        <Title>\n          {title}\n        </Title>\n        <Action\n          onClick={e => e.stopPropagation()}\n        >\n          {(actionRender && hoved && id === activeID) ? actionRender() : null}\n        </Action>\n      </Header>\n\n      <Panel\n        isShow={id === activeID}\n        height={panelHeight}\n      >\n        {children}\n      </Panel>\n    </Container>\n  ))\n\n  return el;\n}\nconst S = {\n  Container: styled.div``,\n  Title: styled.div`\n    display: inline-block;\n    padding-left: 4px;\n  `,\n  Header: styled.div`\n    user-select: none;\n    cursor: pointer;\n    font-size: 12px;\n    color: #fff;\n    font-weight: 600;\n    background-color: #000;\n    padding: 2px 4px;\n  `,\n  Action: styled.div`\n    float: right;\n  `,\n  Panel: styled.div<{ isShow: boolean, height: number }>`\n    overflow: auto;\n    height: ${props => props.isShow ? props.height : 0}px;\n    transition: height 0.1s;\n  `,\n}\n","import { useReducer } from \"react\";\nimport { produce } from 'immer';\n\nexport type StateFn<S> = (state: S) => S;\n\nexport function useFnReducer<S>(initState: S) {\n  const FnReducer = (state: S, afn: StateFn<S>) => afn(state);\n  return useReducer(FnReducer, initState);\n}\nexport type ChangeDispatch<S> = (changeFn: (darft: S) => void) => void\n\nexport type ProduceHook = typeof useProduce;\nexport type ProduceStore<S> = [S, ChangeDispatch<S>]\nexport function useProduce<S>(initState: S): [S, ChangeDispatch<S>] {\n  const [state, _dispatch] = useFnReducer(initState);\n  const dispatch = (changeFn: (darft: S) => void) => _dispatch((state: S) => produce(state, changeFn));\n  return [state, dispatch];\n}\n\nexport type SetDispatch<S> = {\n  [k in keyof S]: (value: S[k]) => void\n};\n\nexport type SetterStore<S> = { get: S, set: SetDispatch<S> };\nexport function useSetter<S>(initState: S): SetterStore<S> {\n  const [get, _dispatch] = useProduce(initState);\n  const set: SetDispatch<S> =\n    new Proxy({}, {\n      get(_, p) {\n        return (value: any) => {\n          _dispatch(darft => {\n            darft[p] = value\n          });\n        };\n      }\n    }) as SetDispatch<S>;\n  return {\n    get,\n    set,\n  };\n}","import { ValueObject } from './bitmap';\nexport interface Bin {\n  width: number;\n  height: number;\n  data: string;\n}\n\n\n/**\n * 画图模式\n */\nexport enum DrawMode {\n  /**\n   * 普通\n   */\n  normal,\n  /**\n   * 左右对称\n   */\n  lrs,\n  /**\n   * 上下对称\n   */\n  uds,\n  /**\n   * 中心对称\n   */\n  centrosymmetry,\n\n}\n\n/**\n * 画图工具\n */\nexport enum DrawTool {\n  /**\n   * 铅笔\n   */\n  pancel = 'pancel',\n\n  /**\n   * 油漆桶\n   */\n  bucket = 'bucket',\n}\n\nexport class BinValue implements Bin, ValueObject<Bin> {\n  constructor(\n    public readonly width: number,\n    public readonly height: number,\n    public readonly data: string,\n  ) { }\n\n  public static createNone(width: number, height: number) {\n    return new BinValue(width, height, '');\n  }\n\n  eq(v: Bin): boolean {\n    return this.width === v.width && this.height === v.height && this.data === v.data;\n  }\n  clone(): BinValue {\n    return new BinValue(this.width, this.height, this.data);\n  }\n}\n\n\n","import { useProduce, ChangeDispatch } from \"./utils\";\n\nexport type PrimaryKey = number;\n\nexport type Entry<T> = T & { id: PrimaryKey };\n\nexport interface EntryTableState<T> {\n  autoID: PrimaryKey,\n  entries: {\n    [priKey: number]: Entry<T>\n  },\n}\n\nexport interface EntryTableDispatch<T> {\n  /**\n   * 插入数据\n   */\n  insert: (...entries: T[]) => void;\n\n  /**\n   * 通过id删除数据\n   */\n  removeById: (id: PrimaryKey) => void;\n\n  /**\n   * 通过过滤器删除数据\n   */\n  removeByFilter: (filter: (item: Entry<T>) => boolean) => void;\n\n  /**\n   * 修改数据\n   */\n  updateById: (id: PrimaryKey, value: T) => void;\n\n  /**\n   * 通过mapper更新数据\n   */\n  updateByMapper: (mapper: (item: Entry<T>) => Entry<T>) => void;\n\n}\n\nexport type EntryTableStore<T> = { table: EntryTableState<T>, entries: Entry<T>[] } & EntryTableDispatch<T>;\n\ntype Dispatch<T> = (changeFn: (darft: EntryTableState<T>) => void) => void;\n\nconst insert = <T>(dispatch: Dispatch<T>) => (...entries: T[]) => dispatch(\n  draft => {\n    entries.forEach(entry => {\n      const id = draft.autoID;\n      draft.entries[id] = { ...entry, id };\n      draft.autoID++;\n    });\n  }\n);\n\nconst removeById = <T>(dispatch: Dispatch<T>) => (id: PrimaryKey) => dispatch(draft => {\n  if (id in draft.entries) {\n    delete draft.entries[id];\n  } else {\n    throw new Error('not found');\n  }\n});\n\nconst updateById = <T>(dispatch: Dispatch<T>) => (id: PrimaryKey, value: T) => dispatch(draft => {\n  if (id in draft.entries) {\n    draft.entries[id] = { ...value, id };\n  } else {\n    throw new Error('not found');\n  }\n});\n\nconst removeByFilter = <T>(dispatch: Dispatch<T>) => (filter: (item: Entry<T>) => boolean) => dispatch(draft => {\n  draft.entries = Object.values(draft.entries)\n    .filter(item => !filter(item))\n    .reduce((item, sum) => ({\n      [item.id]: item,\n      ...sum,\n    }));\n});\n\nconst updateByMapper = <T>(dispatch: Dispatch<T>) => (mapper: (item: Entry<T>) => Entry<T>) => dispatch(draft => {\n  draft.entries = Object.values(draft.entries)\n    .map(mapper)\n    .reduce((item, sum) => ({\n      [item.id]: item,\n      ...sum,\n    }));\n})\n\n\nexport function useEntryTable<T>(): EntryTableStore<T> {\n  const [table, dispatch] = useProduce<EntryTableState<T>>({\n    autoID: 1,\n    entries: {},\n  });\n  return {\n    table,\n    entries: Object.values(table.entries),\n    insert: insert<T>(dispatch),\n    removeById: removeById<T>(dispatch),\n    updateById: updateById<T>(dispatch),\n    removeByFilter: removeByFilter<T>(dispatch),\n    updateByMapper: updateByMapper<T>(dispatch),\n  };\n}\n\n\n\n\n\n","import React, { useMemo, useState } from 'react';\nimport { useFnReducer, StateFn, SetterStore, useSetter } from '../hooks/utils';\nimport { BitMap, Color } from '@/src/components/canvas/bitmap';\nimport { produce } from 'immer';\nimport { DrawMode, DrawTool } from '@/src/components/canvas/types';\nimport { EntryTableState, EntryTableStore, useEntryTable } from '../hooks/useEntryTable';\nimport { useKeyPressEvent } from 'react-use';\n\nexport interface BlockGroup {\n  /**\n   * 色块组名称\n   */\n  name: string;\n  /**\n   * 色块组宽度\n   */\n  groupWidth: number;\n  /**\n   * 色块组高度\n   */\n  groupHeight: number;\n  /**\n   * 色块尺寸\n   */\n  blockSize: number;\n}\n\nexport interface ColorBitMap {\n  /**\n   * 所属的组ID\n   */\n  groupID: number;\n  /**\n   * 色块\n   */\n  map: BitMap<Color>;\n}\nexport interface Options {\n  /**\n   * 色块像素尺寸\n   */\n  pixelSize: number;\n  /**\n   * 当前画笔颜色\n   */\n  color: Color;\n  /**\n   * 是否开启网格\n   */\n  grid: boolean;\n  /**\n   * 绘画模式\n   */\n  drawMode: DrawMode;\n  /**\n   * 绘画工具\n   */\n  tool: DrawTool;\n  /**\n   * 当前鼠标在画布上的位置\n   */\n  pos: [number, number];\n}\nexport interface EditorContextStore {\n\n  /**\n   * 当前正在编辑的色块ID\n   */\n  activeBitMapID: number;\n  setActiveBitMapID: (id: number) => void,\n\n  /**\n   * 单值选项\n   */\n  options: SetterStore<Options>;\n  /**\n   * 色块组表\n   */\n  blockGroups: EntryTableStore<BlockGroup>;\n  /**\n   * 色块表\n   */\n  colorBitMaps: EntryTableStore<ColorBitMap>;\n\n  /**\n   * 添加色块组并添加相引数量的色块到色块表\n   */\n  appendBlockGroup: (name: string, groupWidth: number, groupHeight: number, blockSize: number) => void;\n\n}\n\n\n\nconst EditorContext = React.createContext<EditorContextStore>(undefined);\n\nexport const useEditorContext = () => React.useContext(EditorContext);\n\nexport function useEditorContextStore(): EditorContextStore {\n  const options = useSetter<Options>({\n    color: Color.black,\n    grid: true,\n    pixelSize: 20,\n    pos: [0, 0],\n    tool: DrawTool.pancel,\n    drawMode: DrawMode.normal,\n  });\n  const [activeBitMapID, setActiveBitMapID] = useState<number>();\n  const blockGroups = useEntryTable<BlockGroup>();\n  const colorBitMaps = useEntryTable<ColorBitMap>();\n\n  const appendBlockGroup = (name: string, groupWidth: number, groupHeight: number, blockSize: number) => {\n    const groupID = blockGroups.table.autoID;\n    blockGroups.insert({\n      blockSize,\n      groupHeight,\n      groupWidth,\n      name,\n    });\n    colorBitMaps.insert(...(new Array(groupWidth * groupHeight)\n      .fill(0)\n      .map(() => ({\n        groupID,\n        map: new BitMap<Color>(blockSize, blockSize, Color.none)\n      }))));\n  }\n\n  useKeyPressEvent(e => e.key === 'q', () => {\n    if (options.get.tool === DrawTool.pancel) {\n      options.set.tool(DrawTool.bucket)\n    } else if (options.get.tool === DrawTool.bucket) {\n      options.set.tool(DrawTool.pancel)\n    }\n  });\n  useKeyPressEvent(e => e.key === 'w', () => {\n    if (options.get.drawMode === DrawMode.normal) {\n      options.set.drawMode(DrawMode.lrs);\n    } else if (options.get.drawMode === DrawMode.lrs) {\n      options.set.drawMode(DrawMode.uds);\n    } else if (options.get.drawMode === DrawMode.uds) {\n      options.set.drawMode(DrawMode.centrosymmetry);\n    } else if (options.get.drawMode === DrawMode.centrosymmetry) {\n      options.set.drawMode(DrawMode.normal);\n    }\n  });\n  return {\n    activeBitMapID,\n    setActiveBitMapID,\n    options,\n    blockGroups,\n    colorBitMaps,\n    appendBlockGroup,\n  }\n}\n\n\n\nexport function EditorContextProvder(props: { children?: React.ReactElement | React.ReactElement[] }) {\n\n  return (\n    <EditorContext.Provider\n      value={useEditorContextStore()}\n    >\n      {props.children}\n    </EditorContext.Provider>\n  );\n};","import { useReducer, Reducer } from 'react';\n\nconst toggleReducer = (state: boolean, nextValue?: any) => (typeof nextValue === 'boolean' ? nextValue : !state);\n\nexport const useToggle = (initialValue: boolean = true): [boolean, (nextValue?: any) => void] =>\n  useReducer<Reducer<boolean, any>>(toggleReducer, initialValue);","import React, { useRef, useMemo } from 'react';\nimport { useMouse } from 'react-use';\nimport styled from '@emotion/styled';\n\ntype MouseHandle = (x: number, y: number) => void;\n\nconst clap = (min: number, max: number) => (v: number) => {\n  if (v < min) {\n    return min;\n  } else if (v > max) {\n    return max;\n  }\n  return v;\n}\n\nexport interface PixelBoardProps extends UsePixelBoardProps {\n  grid?: boolean;\n  children?: React.ReactNode;\n  onMouseDown?: MouseHandle;\n  onMouseLeave?: MouseHandle;\n  onMouseUp?: MouseHandle;\n  onMouseMove?: MouseHandle;\n  onClick?: MouseHandle;\n}\n\nexport interface UsePixelBoardProps {\n  width: number;\n  height: number;\n  pixelSize?: number;\n}\n\nexport function usePixelBoard<T>(props: UsePixelBoardProps & { ref: React.MutableRefObject<Element> }) {\n  const {\n    ref,\n    height,\n    width,\n  } = props;\n  const pixelSize = props.pixelSize ?? 1;\n  const { elX, elY } = useMouse(ref);\n  const pos: [number, number] = useMemo(() => [\n    clap(0, width - 1)(Math.floor(elX / pixelSize)),\n    clap(0, height - 1)(Math.floor(elY / pixelSize))\n  ], [elX, elY]);\n  return pos;\n}\n\nexport function PixelBoard(props: PixelBoardProps) {\n  const {\n    height,\n    width,\n    children,\n    onMouseDown,\n    onMouseLeave,\n    onMouseMove,\n    onMouseUp,\n    onClick,\n  } = props;\n  const pixelSize = props.pixelSize ?? 1;\n  const grid = props.grid ?? false;\n  const ref = useRef<HTMLDivElement>(null);\n  const pos = usePixelBoard({ ...props, ref });\n  const {\n    Container,\n    Board,\n  } = S;\n  const gridStyle = grid ? {\n    backgroundImage: 'linear-gradient(#a9abac 1px,transparent 0),linear-gradient(90deg, #a9abac 1px,transparent 0)',\n    backgroundSize: `${pixelSize}px ${pixelSize}px`,\n    borderRight: '1px solid #a9abac',\n    borderBottom: '1px solid #a9abac',\n  } : {\n      border: '1px solid #a9abac',\n    };\n  return (\n    <Container>\n      <Board\n        ref={ref}\n        style={{\n          width: width * pixelSize,\n          minWidth: width * pixelSize,\n          maxWidth: width * pixelSize,\n          height: height * pixelSize,\n          minHeight: height * pixelSize,\n          maxHeight: height * pixelSize,\n          ...gridStyle,\n        }}\n        onMouseDown={() => onMouseDown ? onMouseDown(...pos) : null}\n        onMouseLeave={() => onMouseLeave ? onMouseLeave(...pos) : null}\n        onMouseUp={() => onMouseUp ? onMouseUp(...pos) : null}\n        onMouseMove={() => onMouseMove ? onMouseMove(...pos) : null}\n        onClick={() => onClick ? onClick(...pos) : null}\n      />\n      {children}\n    </Container>\n\n  )\n}\n\nconst S = {\n  Container: styled.div`\n    position: relative;\n  `,\n  Board: styled.div`\n    position: absolute;\n  `\n};\n","import React, { useRef, useState, useMemo, useEffect } from 'react';\nimport styled from '@emotion/styled';\nimport { useToggle } from '@/src/hooks';\nimport { useKey } from 'react-use';\nimport { useStask } from '@/src/hooks/useStask';\nimport { BitMap, Color } from './bitmap';\nimport { PixelBoard } from './PixelBoard';\nimport { BW2x2, CURSOR_PANCEL32x32_DATA_URL, CURSOR_BUCKET32x32_DATA_URL } from '../bins';\nimport { bitMap2Image, base642BitMap, bitMap2ImageData } from './utils';\nimport { DrawMode, DrawTool } from './types';\n\nexport interface CanvasProps {\n  onBitMapChange?: (bitMap: BitMap<Color>) => void;\n  bitMap: BitMap<Color>;\n  /**\n   * 像素块大小\n   */\n  pixelSize: number;\n  drawMode?: DrawMode;\n  preview?: boolean;\n  color?: Color;\n  onOperationFinish?: (bitMap: BitMap<Color>) => void;\n  onMouseMove?: (xy: [number, number]) => void;\n  grid?: boolean;\n  tool?: DrawTool;\n}\n\nexport function Canvas(props: CanvasProps) {\n  const {\n    pixelSize,\n    onOperationFinish,\n    bitMap,\n    onBitMapChange,\n    onMouseMove,\n  } = props;\n  const { width, height } = useMemo(() => ({ width: bitMap.width, height: bitMap.height }), [bitMap]);\n  const drawMode = props.drawMode ?? DrawMode.normal;\n  const preview = props.preview ?? false;\n  const grid = props.grid ?? false;\n  const tool = props.tool ?? DrawTool.pancel;\n  const color = props.color || Color.black;\n  const canvas = useRef<HTMLCanvasElement | null>(null);\n  const [isDown, toggleDU] = useToggle(false);\n  const backgroundImageURL = useMemo(() => bitMap2Image(base642BitMap(BW2x2), pixelSize).toDataURL(),\n    [pixelSize, BW2x2])\n\n  useEffect(() => {\n    const { current } = canvas;\n    if (current) {\n      const ctx = current.getContext('2d');\n      if (ctx) {\n        ctx.putImageData(bitMap2ImageData(bitMap, pixelSize), 0, 0);\n      }\n    }\n  }, [canvas, bitMap, pixelSize]);\n\n\n\n  const fillRect = useMemo(() => (bitMap: BitMap<Color>, _x: number, _y: number) => {\n    if (bitMap.get(_x, _y).eq(color)) {\n      return bitMap;\n    }\n    return bitMap.clone().put(_x, _y, color);\n  }, [color]);\n\n  const pencelDraw = useMemo(() => (bx: number, by: number) => {\n    const { width, height } = bitMap;\n    // 当前点\n    let b = fillRect(bitMap, bx, by);\n    if (drawMode === DrawMode.lrs) {\n      // 左右对称点\n      b = fillRect(b, width - (bx + 1), by);\n    }\n    if (drawMode === DrawMode.uds) {\n      b = fillRect(b, bx, height - (by + 1));\n    }\n    if (drawMode === DrawMode.centrosymmetry) {\n      b = fillRect(b, width - (bx + 1), height - (by + 1));\n    }\n    // 提交变更\n    if (!b.eq(bitMap) && onBitMapChange) {\n      onBitMapChange(b);\n    }\n  }, [fillRect, pixelSize, onBitMapChange, drawMode, bitMap]);\n\n  const bucketDraw = useMemo(() => (bx: number, by: number) => {\n    let b = bitMap.fillArea(bx, by, color);\n    // 提交变更\n    if (onBitMapChange)\n      onBitMapChange(b);\n  }, [fillRect, pixelSize, onBitMapChange, bitMap, color]);\n\n  let draw = pencelDraw;\n\n  switch (tool) {\n    case DrawTool.bucket: draw = bucketDraw; break;\n    default: draw = pencelDraw;\n  }\n\n  const handleMouseDown = useMemo(() => (x: number, y: number) => {\n    toggleDU(true);\n    // 把绘图前的状态存一下\n    if (onOperationFinish) {\n      onOperationFinish(bitMap.clone());\n    }\n    draw(x, y);\n  }, [toggleDU, draw, bitMap, onOperationFinish]);\n\n  const handleMouseUp = useMemo(() => () => {\n    toggleDU(false);\n  }, [])\n\n  const handleMouseMove = useMemo(() => (x: number, y: number) => {\n    if (isDown) {\n      draw(x, y);\n    }\n    if (onMouseMove) {\n      onMouseMove([x, y]);\n    }\n  }, [isDown, draw]);\n\n  const {\n    Container,\n    DrawCanvas,\n  } = S;\n  return (\n    <Container\n      style={{\n        cursor: tool === DrawTool.pancel ? `url(${CURSOR_PANCEL32x32_DATA_URL}),default` : `url(${CURSOR_BUCKET32x32_DATA_URL}),default`,\n      }}\n    >\n      <PixelBoard\n        {...{ width, height, pixelSize, grid }}\n        onMouseDown={handleMouseDown}\n        onMouseLeave={handleMouseUp}\n        onMouseUp={handleMouseUp}\n        onMouseMove={handleMouseMove}\n      >\n        <DrawCanvas\n          ref={canvas}\n          style={{\n            backgroundImage: grid ? 'none' : `url(${backgroundImageURL})`\n          }}\n          {...{\n            width: width * pixelSize,\n            height: height * pixelSize\n          }}\n        />\n      </PixelBoard>\n    </Container>\n  );\n}\n\nexport const useCanvas = (width: number, height: number, pixelSize: number): CanvasProps => {\n  const [bitMap, onBitMapChange] = useState<BitMap<Color>>(new BitMap(width, height, Color.none));\n  // change bitMap的宽高时的变化\n  useEffect(() => {\n    if (width !== bitMap.width || height !== bitMap.height) {\n      const newBitMap = bitMap.updateSize(Color.none, width, height);\n      onBitMapChange(newBitMap);\n    }\n  }, [width, height])\n  return {\n    pixelSize,\n    color: Color.black,\n    bitMap,\n    onBitMapChange,\n  }\n}\n\nconst S = {\n  Container: styled.div`\n    display: inline-block;\n  `,\n  DrawCanvas: styled.canvas``,\n};\n\nexport function useUndo({\n  onBitMapChange,\n}: {\n  onBitMapChange?: (bitMap: BitMap<Color>) => void;\n}) {\n  const [top, length, { pop, push }] = useStask();\n\n  useKey(\n    event => event.key === 'z' && event.metaKey === true,\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (top && onBitMapChange) {\n        onBitMapChange(top as any);\n      }\n      if (length > 0) {\n        pop();\n      }\n    }, { event: 'keydown' });\n  const handleOperationFinish = (bit: BitMap<Color>) => {\n    push(bit.clone());\n  }\n  return handleOperationFinish;\n}\n\n","import { useState, useMemo } from 'react';\n\nexport type Stask<T> = [T | undefined, number, {\n  push: (item: T) => void;\n  pop: () => void;\n  clear: () => void;\n}]\n\nexport function useStask<T>(defaultValue?: T[]): Stask<T> {\n  const [data, setData] = useState<T[]>(defaultValue ?? []);\n  const push = useMemo(() => (v: T) => {\n    setData([...data, v]);\n  }, [data, setData]);\n  const top = useMemo(() => data.length > 0 ? data[data.length - 1] : undefined, [data]);\n  const pop = useMemo(() => () => {\n    setData(data.slice(0, data.length - 1));\n  }, [data, setData]);\n  const clear = () => setData([]);\n  const length = useMemo(() => data.length, [data]);\n  return [top, length, {\n    push,\n    pop,\n    clear,\n  }]\n}","import React, { useEffect } from 'react';\nimport { BitMap, Color } from './bitmap';\nimport { useBitMap2Image } from './utils';\nimport { BW2x2_DATA_URL } from '../bins';\n\nfunction useDebounce<T>(value: T, delay: number) {\n  const [debouncedValue, setDebouncedValue] = React.useState(value)\n  React.useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    return () => {\n      clearTimeout(handler)\n    }\n  }, [value, delay])\n  return debouncedValue\n}\n\nexport function ColorBitMapRender(props: { bitMap: BitMap<Color>, size?: number }) {\n  const { bitMap } = props;\n  const size = props.size ?? 1;\n  const ref = React.createRef<HTMLCanvasElement>();\n  // const _bitMap = useDebounce(bitMap, 1000);\n  // useBitMap2Image(ref, _bitMap, size);\n  useEffect(() => {\n    if (ref.current) {\n      const canvas = ref.current;\n      const { width, height } = bitMap;\n      canvas.width = width * size;\n      canvas.height = height * size;\n      const ctx = canvas.getContext('2d');\n      for (let x = 0; x < width; x++)\n        for (let y = 0; y < height; y++) {\n          const c = bitMap.get(x, y);\n          const { r, g, b, a } = c;\n          ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n          ctx.fillRect(x * size, y * size, size, size);\n        }\n    }\n  }, [bitMap])\n\n  return (\n    <canvas\n      ref={ref}\n      style={{\n        width: bitMap.width * size,\n        height: bitMap.height * size,\n        backgroundColor: '#fff',\n        backgroundImage: `url(${BW2x2_DATA_URL})`,\n        backgroundRepeat: 'repeat',\n        backgroundSize: 8,\n      }}\n    />\n  )\n}\n\n\n\n","import React, { useEffect } from 'react';\nimport { BitMap, Color } from '@/src/components/canvas/bitmap';\n\nexport function buildCanvas(bitMap: BitMap<Color>, pipe?: (img: ImageData) => ImageData, size?: number): HTMLCanvasElement {\n  const _size = size ?? 1;\n  const canvas = document.createElement('canvas');\n  const { width, height } = bitMap;\n  canvas.width = width * _size;\n  canvas.height = height * _size;\n  const ctx = canvas.getContext('2d');\n  for (let x = 0; x < width; x++)\n    for (let y = 0; y < height; y++) {\n      const c = bitMap.get(x, y);\n      const { r, g, b, a } = c;\n      ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n      ctx.fillRect(x * _size, y * _size, _size, _size);\n    }\n  if (pipe) {\n    ctx.putImageData(pipe(ctx.getImageData(0, 0, canvas.width, canvas.height)), 0, 0);\n  }\n  return canvas;\n}\n\nexport function ColorBitMapPreview(props: { bitMap: BitMap<Color>, size?: number }) {\n  const { bitMap } = props;\n  const size = props.size ?? 10;\n  const ref = React.createRef<HTMLDivElement>();\n  useEffect(() => {\n    if (ref.current) {\n      const build = (pipe: (d: ImageData) => ImageData) => buildCanvas(bitMap, pipe, size);\n      const root = ref.current;\n      const append = (title: string, pipe: (d: ImageData) => ImageData) => {\n        const wrap = document.createElement('div');\n        const label = document.createElement('span');\n        label.textContent = title;\n        wrap.appendChild(label);\n        wrap.appendChild(build(pipe));\n        root.appendChild(wrap);\n      }\n      append('原始:', x => x);\n      append('invert 滤镜:', window.bex.bild.effect.invert);\n      append('sepia 滤镜:', window.bex.bild.effect.sepia);\n      append('emboss 滤镜:', window.bex.bild.effect.emboss);\n      append('grayscale 滤镜:', window.bex.bild.effect.grayscale);\n      append('sharpen 滤镜:', window.bex.bild.effect.sharpen);\n      append('sobel 滤镜:', window.bex.bild.effect.sobel);\n      append('dilate 0.5 滤镜:', img => window.bex.bild.effect.dilate(img, 0.5));\n      append('edge_detection 0.5 滤镜:', img => window.bex.bild.effect.edge_detection(img, 0.5));\n      append('erode 0.5 滤镜:', img => window.bex.bild.effect.erode(img, 0.5));\n      append('grayscale_with_weights 0.5 滤镜:', img => window.bex.bild.effect.grayscale_with_weights(img, 0.5, 0.5, 0.5));\n      append('median 0.5 滤镜:', img => window.bex.bild.effect.median(img, 0.5));\n      append('unsharp_mask 0.5 滤镜:', img => window.bex.bild.effect.unsharp_mask(img, 0.5, 0.5));\n\n    }\n  }, [bitMap, size]);\n\n  return (\n    <div\n      style={{\n        display: 'grid',\n        gridTemplateColumns: '1fr 1fr 1fr 1fr',\n        gridGap: 20,\n      }}\n      ref={ref}\n    />\n  );\n}","import React from 'react';\nimport styled from '@emotion/styled';\nimport { BitMap, Color } from '../../canvas/bitmap';\nimport { useEditorContext } from '@/src/context/EditorContext';\nimport { BW2x2_DATA_URL } from '../../bins';\nimport { ColorBitMapRender } from '../../canvas';\nconst pixelSize = 32;\n\nexport function BlockGroupList() {\n  const {\n    blockGroups,\n    colorBitMaps,\n    activeBitMapID,\n    setActiveBitMapID,\n  } = useEditorContext();\n  const {\n    Container,\n    BlockGroupItem,\n    Header,\n    BlockSelectPanel,\n    Grid,\n    Placeholder,\n  } = S;\n  return (\n    <Container>\n      {blockGroups.entries.map(blockGroup => (\n        <BlockGroupItem key={blockGroup.id}>\n          <Header>\n            <span>{blockGroup.name}</span>\n          </Header>\n          <BlockSelectPanel>\n            <Grid\n              style={{\n                gridTemplateColumns: `repeat(${blockGroup.groupWidth},${blockGroup.blockSize}px)`,\n                width: blockGroup.blockSize * blockGroup.groupWidth,\n                height: blockGroup.blockSize * blockGroup.groupHeight,\n              }}\n            >\n              {colorBitMaps.entries\n                .filter(colorBitMap => colorBitMap.groupID === blockGroup.id)\n                .map(colorBitMap => {\n                  const BlockContainer = (props: { children?: React.ReactElement }) => (\n                    <div\n                      onClick={() => setActiveBitMapID(colorBitMap.id)}\n                      style={{\n                        width: colorBitMap.map.width,\n                        height: colorBitMap.map.height,\n                        overflow: 'hidden',\n                        border: colorBitMap.id !== activeBitMapID ? '1px solid #fff' : '1px solid red',\n                      }}\n                    >\n                      {props.children}\n                    </div>\n                  );\n                  if (colorBitMap.map.eq(new BitMap<Color>(blockGroup.blockSize, blockGroup.blockSize, Color.none))) {\n                    return (\n                      <BlockContainer\n                        key={colorBitMap.id}\n                      >\n                        <Placeholder />\n                      </BlockContainer>\n\n                    );\n                  } else {\n                    return (\n                      <BlockContainer\n                        key={colorBitMap.id}\n                      >\n                        <ColorBitMapRender\n                          bitMap={colorBitMap.map}\n                        />\n                      </BlockContainer>\n                    )\n                  }\n                })}\n            </Grid>\n          </BlockSelectPanel>\n        </BlockGroupItem>\n      ))}\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div`\n    height: 100%;\n  `,\n  BlockGroupItem: styled.div`\n    user-select: none;\n    text-align: center;\n    /* cursor: pointer; */\n    \n  `,\n  Header: styled.div`\n    color: #fff;\n  `,\n  BlockSelectPanel: styled.div`\n    margin: auto;\n    display: inline-block;\n    cursor: pointer;\n  `,\n  Grid: styled.div`\n    display: grid;\n  `,\n  Placeholder: styled.div`\n    width: ${pixelSize}px;\n    height: ${pixelSize}px;\n    background-color: #fff;\n    background-image: url(${BW2x2_DATA_URL});\n    background-repeat: repeat;\n    background-size: 8px 8px;\n  `,\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { useFnReducer } from '@/src/hooks/utils';\nimport { Form, Input, InputNumber } from 'antd';\n\nexport interface BlockGroupPropsFormProps {\n\n}\nexport interface BlockGroupPropsFormState extends BlockGroupPropsFormProps {\n  name: string;\n  groupWidth: number;\n  groupHeight: number;\n  blockSize: number;\n}\n\nconst initState: BlockGroupPropsFormState = {\n  name: '',\n  blockSize: 32,\n  groupHeight: 3,\n  groupWidth: 3,\n};\n\nexport interface BlockGroupPropsFormDispatch {\n  setName: (name: string) => void;\n  setGroupWidth: (width: number) => void;\n  setGroupHeight: (height: number) => void;\n  setBlockSize: (size: number) => void;\n}\n\nexport type BlockGroupPropsFormStore = BlockGroupPropsFormState & BlockGroupPropsFormDispatch;\n\nexport function useBlockGroupPropsForm(): BlockGroupPropsFormStore {\n  const [state, dispatch] = useFnReducer(initState);\n  const setName = (name: string) => dispatch(state => ({ ...state, name }));\n  const setGroupWidth = (groupWidth: number) => dispatch(state => ({ ...state, groupWidth }));\n  const setGroupHeight = (groupHeight: number) => dispatch(state => ({ ...state, groupHeight }));\n  const setBlockSize = (blockSize: number) => dispatch(state => ({ ...state, blockSize }));\n  return {\n    ...state,\n    setGroupWidth,\n    setGroupHeight,\n    setBlockSize,\n    setName,\n  };\n}\n\nexport function PureBlockGroupPropsForm(props: BlockGroupPropsFormStore) {\n  const {\n    blockSize,\n    groupHeight,\n    groupWidth,\n    name,\n    setBlockSize,\n    setGroupHeight,\n    setGroupWidth,\n    setName,\n  } = props;\n  const {\n    Container\n  } = S;\n  return (\n    <Container>\n      <Form>\n        <Form.Item label={\"名称\"}>\n          <Input value={name} onChange={e => setName(e.target.value)} />\n        </Form.Item>\n        <Form.Item label={\"色块组尺寸\"}>\n          <InputNumber\n            min={1}\n            max={3}\n            value={groupWidth}\n            onChange={setGroupWidth}\n          />\n          <InputNumber\n            min={1}\n            max={3}\n            value={groupHeight}\n            onChange={setGroupHeight}\n          />\n        </Form.Item>\n        <Form.Item label={\"色块尺寸\"}>\n          <InputNumber value={blockSize} onChange={setBlockSize} />\n        </Form.Item>\n      </Form>\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div`\n    padding: 16px;\n  `,\n}\nexport function BlockGroupPropsForm() {\n  return <PureBlockGroupPropsForm {...useBlockGroupPropsForm()} />\n}\n","import React, { useState } from 'react';\nimport styled from '@emotion/styled';\nimport { AccordionPanel } from '@/src/components/accordion/AccordionPanel'\nimport { BlockGroupList } from '@/src/components/list/BlockGroupList/BlockGroupList';\nimport { useToggle } from 'react-use';\nimport { BinIcon } from '@/src/components/icon/BinIcon';\nimport { Modal } from 'antd';\nimport { PureBlockGroupPropsForm, useBlockGroupPropsForm } from '@/src/components/form/BlockGroupPropsForm';\nimport { useEditorContext } from '@/src/context/EditorContext';\n\nexport function BlockGroupSelectPanel() {\n  const [isVisible, toggle] = useToggle(false);\n  const {\n    appendBlockGroup,\n  } = useEditorContext();\n  const blockGroupPropsFormState = useBlockGroupPropsForm();\n  const {\n    Container\n  } = S;\n  return (\n    <Container>\n      <AccordionPanel\n        id=\"BlockGroupSelectPanel\"\n        title=\"色块组\"\n        actionRender={() => (\n          <BinIcon\n            type={\"add_file\"}\n            size={16}\n            onClick={() => {\n              toggle(true);\n            }}\n          />\n        )}\n      >\n        <BlockGroupList />\n      </AccordionPanel>\n      <Modal\n        visible={isVisible}\n        onCancel={toggle}\n        title=\"添加色块组\"\n        onOk={() => {\n          const {\n            name,\n            groupWidth,\n            groupHeight,\n            blockSize,\n          } = blockGroupPropsFormState;\n          appendBlockGroup(\n            `${name} (${groupWidth}x${groupHeight})`,\n            groupWidth,\n            groupHeight,\n            blockSize,\n          );\n          toggle();\n          blockGroupPropsFormState.setName(\"\");\n        }}\n      >\n        <PureBlockGroupPropsForm {...blockGroupPropsFormState} />\n      </Modal>\n    </Container>\n  );\n}\n\nBlockGroupSelectPanel.id = 'BlockGroupSelectPanel';\nconst S = {\n  Container: styled.div``,\n}\n","import React, { useState, useMemo, useEffect } from 'react';\nimport styled from '@emotion/styled';\nimport { Color } from './bitmap';\nimport { useList, useKeyPress, useKeyPressEvent } from 'react-use';\nimport { SketchPicker, RGBColor } from 'react-color';\n\n\nexport interface PaletteProps {\n  color: Color,\n  size?: number,\n  onChangeColor: (color: Color) => void,\n}\n\nexport function usePalette(defaultColor: Color = Color.black): PaletteProps {\n  const [color, onChangeColor] = useState<Color>(defaultColor);\n  return { color, onChangeColor }\n}\n\nexport function Palette(props: PaletteProps) {\n  const {\n    color,\n    onChangeColor,\n  } = props;\n  const size = props.size ?? 32;\n  const defaultColorList = [\n    new Color(0, 0, 0, 1),\n    new Color(0, 0, 0, 0),\n    new Color(255, 255, 255, 1),\n    new Color(255, 0, 0, 1),\n    new Color(0, 0, 255, 1),\n    new Color(0, 255, 0, 1),\n    new Color(190, 32, 54, 1),\n    new Color(12, 129, 23, 1),\n    new Color(12, 193, 41, 1),\n    new Color(12, 32, 209, 1),\n  ]\n\n  useEffect(() => onChangeColor(defaultColorList[0].clone()), []);\n\n  const [colorList, { updateAt }] = useList<Color>(defaultColorList);\n  const activeColorIndex = useMemo(() => {\n    if (colorList.length === 0 || color === undefined) {\n      return undefined;\n    } else {\n      return colorList.findIndex(c => c && color.eq(c))\n    }\n  }, [colorList, color]);\n\n  const onClickHandle = useMemo(() => (idx: number) => () => {\n    if (colorList[idx]) {\n      if (idx === activeColorIndex) {\n        return;\n      } else {\n        onChangeColor(colorList[idx]);\n      }\n    }\n  }, [colorList, activeColorIndex]);\n\n  const keyDown = useMemo(() => (e: KeyboardEvent) => {\n    if (e.key === '0') {\n      onClickHandle(9)();\n    } else {\n      onClickHandle(+e.key - 1)();\n    }\n  }, [onClickHandle])\n\n  const [isChangeColorModialVisible] = useKeyPress(e => e.key === '`' || e.key === '·');\n  useKeyPressEvent(e => '1234567890'.split('').includes(e.key), keyDown);\n\n  const {\n    Container,\n    ColorBlock,\n    ColorBlockContainer,\n    KeyBoardTip,\n  } = S;\n  return (\n    <Container\n      style={{\n        gridTemplateColumns: `repeat(10,${size}px)`,\n      }}\n    >\n      {colorList.map((cl, idx) => (\n        <ColorBlockContainer\n          key={idx}\n          onClick={onClickHandle(idx)}\n          style={{\n            width: size,\n          }}\n        >\n          <ColorBlock\n            key={idx}\n            color={cl ? cl.rgba : undefined}\n            style={{\n              width: size,\n              height: size,\n            }}\n          />\n          <KeyBoardTip id=\"tip\" acitve={idx === activeColorIndex}>{(idx + 1) % 10}</KeyBoardTip>\n        </ColorBlockContainer>\n      ))}\n      {\n        isChangeColorModialVisible ? (\n          <div\n            style={{\n              position: 'absolute',\n              top: 'calc(50% - 150px)',\n              left: 'calc(50% - 100px)',\n              zIndex: 1000,\n            }}\n          >\n            <SketchPicker\n              color={colorList[activeColorIndex]}\n              onChange={res => {\n                const { r, g, b, a } = res.rgb;\n                updateAt(activeColorIndex, new Color(r, g, b, a));\n                onChangeColor(new Color(r, g, b, a));\n              }}\n            />\n          </div>\n        ) : null\n      }\n    </Container>\n  )\n}\n\nconst S = {\n  Container: styled.div`\n    display: grid;\n  `,\n  ColorBlock: styled.div<{ color?: string }>`\n    background-color: ${props => props.color ?? '#fff'};\n  `,\n  ColorBlockContainer: styled.div`\n    text-align: center;\n    cursor: pointer;\n    &:hover > #tip {\n      line-height: 6px;\n      border: solid 1px blue;\n    }\n  `,\n  KeyBoardTip: styled.div<{ acitve?: boolean }>`\n    font-size: 8px;\n    line-height: ${props => props.acitve ? '6px' : '8px'};\n    border: ${props => props.acitve ? 'solid 1px red' : 'none'};\n    padding: 4px 0;\n    user-select: none;\n  `,\n};\n","import React, { useState } from 'react';\nimport styled from '@emotion/styled';\nimport { useEditorContext } from '../context/EditorContext';\nimport { Palette } from '../components/canvas/Palette';\nimport {\n  Canvas,\n  useUndo,\n  DrawMode,\n  DrawTool,\n  ColorBitMapPreview,\n  bitMap2Base64,\n} from '@/src/components/canvas';\nimport {\n  Switch,\n  Radio,\n  Button,\n  Modal,\n  message,\n} from 'antd';\nimport { Color } from '@/src/components/canvas/bitmap';\nimport { useCopyToClipboard } from 'react-use';\n\nexport function ToolBar() {\n  const {\n    Container,\n    InlineBlock\n  } = S;\n  const {\n    options,\n    colorBitMaps,\n    activeBitMapID,\n  } = useEditorContext();\n  const [visible, setVisible] = useState<boolean>(false);\n  const handleCanvasOperationFinish = useUndo({\n    onBitMapChange: map => colorBitMaps.updateById(activeBitMapID, {\n      ...colorBitMaps.table.entries[activeBitMapID],\n      map,\n    })\n  });\n  const [_, copy] = useCopyToClipboard();\n  return (\n    <Container>\n      <InlineBlock>\n        <Button size=\"small\" type=\"primary\" onClick={() => {\n          const activeBitMap = colorBitMaps.table.entries[activeBitMapID];\n          handleCanvasOperationFinish(activeBitMap.map);\n          colorBitMaps.updateById(\n            activeBitMapID,\n            {\n              ...activeBitMap,\n              map: activeBitMap.map.fill(Color.none),\n            });\n        }}>清空</Button>\n      </InlineBlock>\n      <InlineBlock>\n        <Radio.Group size=\"small\" value={options.get.tool} onChange={e => options.set.tool(e.target.value)} buttonStyle=\"solid\">\n          <Radio.Button value={DrawTool.pancel}>画笔</Radio.Button>\n          <Radio.Button value={DrawTool.bucket}>油漆桶</Radio.Button>\n        </Radio.Group>\n      </InlineBlock>\n      <InlineBlock>\n        <Palette\n          size={16}\n          color={options.get.color}\n          onChangeColor={options.set.color}\n        />\n      </InlineBlock>\n      <InlineBlock>\n        <Radio.Group size=\"small\" value={options.get.drawMode} onChange={e => options.set.drawMode(e.target.value)} buttonStyle=\"solid\">\n          <Radio.Button value={DrawMode.normal}>无</Radio.Button>\n          <Radio.Button value={DrawMode.lrs}>左右</Radio.Button>\n          <Radio.Button value={DrawMode.uds}>上下</Radio.Button>\n          <Radio.Button value={DrawMode.centrosymmetry}>中心</Radio.Button>\n        </Radio.Group>\n      </InlineBlock>\n\n      <InlineBlock>\n        <span><a href=\"#\" onClick={() => setVisible(true)}>预览</a></span>\n      </InlineBlock>\n      {/* <InlineBlock>\n        <span>{options.get.pos.join(',')}</span>\n      </InlineBlock> */}\n      <Modal\n        width=\"90%\"\n        visible={visible}\n        title=\"预览\"\n        onCancel={() => setVisible(false)}\n        footer={null}\n      >\n        {visible && (\n          <div>\n            <ColorBitMapPreview\n              bitMap={colorBitMaps.table.entries[activeBitMapID].map}\n              size={10}\n            />\n            <div>code: <a href=\"#\" onClick={() => {\n              copy(JSON.stringify(bitMap2Base64(colorBitMaps.table.entries[activeBitMapID].map), null, 2));\n              message.success('复制成功');\n            }}>复制</a></div>\n            <div\n              style={{\n                overflow: 'atuo',\n                backgroundColor: '#000',\n                color: '#fff',\n              }}\n            >\n              <pre>\n                {JSON.stringify(bitMap2Base64(colorBitMaps.table.entries[activeBitMapID].map), null, 2)}\n              </pre>\n            </div>\n          </div>\n        )}\n      </Modal>\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div`\n  \t/* position: relative; */\n    background-color: #f3f3f3;\n    border-top: 1px solid #cbcccc;\n    height: 36px;\n    font-size: 12px;\n    min-width: 840px;\n    -webkit-box-shadow: inset 0 1px 0 0 #fff;\n    -moz-box-shadow: inset 0 1px 0 0 #fff;\n    box-shadow: inset 0 1px 0 0 #fff;\n    background-color: #f5f5f5;\n    background-image: -webkit-linear-gradient(top,#f5f5f5,#eee);\n    background-image: -moz-linear-gradient(top,#f5f5f5,#eee);\n    background-image: -ms-linear-gradient(top,#f5f5f5,#eee);\n    background-image: -o-linear-gradient(top,#f5f5f5,#eee);\n    background-image: linear-gradient(top,#f5f5f5,#eee);\n    border-bottom: 1px solid #aaaaaa;\n  `,\n  InlineBlock: styled.div`\n    display: inline-block;\n    vertical-align: middle;\n    margin-left: 20px;\n  `,\n}","import React, { useState } from 'react';\nimport styled from '@emotion/styled';\nimport {\n  Canvas,\n  useUndo,\n  DrawMode,\n  DrawTool,\n  ColorBitMapRender,\n  bitMap2Base64,\n} from '@/src/components/canvas';\nimport { Palette } from '@/src/components/canvas/Palette';\nimport {\n  Switch,\n  Radio,\n  Button,\n  Modal,\n  message,\n} from 'antd';\nimport { Color } from '@/src/components/canvas/bitmap';\nimport { useEditorContext } from '@/src/context/EditorContext';\nimport { useCopyToClipboard } from 'react-use';\nimport { ToolBar } from './ToolBar';\n\nexport function BlockEditor() {\n  const {\n    activeBitMapID,\n    options,\n    colorBitMaps,\n  } = useEditorContext();\n  const {\n    Container,\n    CanvasContainer,\n  } = S;\n  const handleCanvasOperationFinish = useUndo({\n    onBitMapChange: map => colorBitMaps.updateById(activeBitMapID, {\n      ...colorBitMaps.table.entries[activeBitMapID],\n      map,\n    })\n  });\n  return (\n    <Container>\n      <ToolBar />\n      <CanvasContainer>\n        <Canvas\n          bitMap={colorBitMaps.table.entries[activeBitMapID].map}\n          onBitMapChange={map => colorBitMaps.updateById(activeBitMapID, {\n            ...colorBitMaps.table.entries[activeBitMapID],\n            map,\n          })}\n          pixelSize={options.get.pixelSize}\n          color={options.get.color}\n          onOperationFinish={handleCanvasOperationFinish}\n          grid={options.get.grid}\n          drawMode={options.get.drawMode}\n          tool={options.get.tool}\n          // onMouseMove={options.set.pos}\n        />\n      </CanvasContainer>\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div`\n  `,\n  CanvasContainer: styled.div`\n    margin: 20px;\n  `,\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { Accordion, AccordionPanel } from '@/src/components/accordion';\nimport {\n  BlockGroupSelectPanel,\n} from './BlockGroupSelectPanel';\nimport {\n  BlockEditor\n} from './BlockEditor';\nimport { useEditorContext } from '@/src/context/EditorContext';\n\nexport function SpirtEditor() {\n  const {\n    options,\n    activeBitMapID,\n    setActiveBitMapID,\n  } = useEditorContext();\n  const {\n    Container,\n    ObjectNavigation,\n    Editor,\n  } = S;\n  return (\n    <Container>\n      <ObjectNavigation>\n        <Accordion defaultActive={BlockGroupSelectPanel.id}>\n          <BlockGroupSelectPanel />\n          <AccordionPanel id=\"Map\" title=\"色块地图\" />\n        </Accordion>\n      </ObjectNavigation>\n      <Editor>\n        {activeBitMapID === undefined ? null : (\n          <BlockEditor />\n        )}\n      </Editor>\n    </Container>\n  );\n}\nconst S = {\n  Container: styled.div`\n    display: grid;\n    grid-template-columns: 240px auto;\n  `,\n  ObjectNavigation: styled.div`\n  `,\n  Editor: styled.div`\n    color: #000;\n  `,\n}\n","import React from 'react';\nimport { SpirtEditor } from \"./SpirtEditor\";\nimport { EditorContextProvder } from \"@/src/context/EditorContext\";\n\nexport default () => (\n  <EditorContextProvder>\n    <SpirtEditor />\n  </EditorContextProvder>\n);","import { BitMap, Color } from \"./bitmap\";\nimport { Bin } from \"./types\";\nimport { useEffect } from \"react\";\nimport { count } from \"console\";\n\nexport function bitMap2Image(bitMap: BitMap<Color>, size: number = 20): HTMLCanvasElement {\n  const canvas = document.createElement('canvas');\n  const { width, height } = bitMap;\n  canvas.width = width * size;\n  canvas.height = height * size;\n  const ctx = canvas.getContext('2d');\n  for (let x = 0; x < width; x++)\n    for (let y = 0; y < height; y++) {\n      const c = bitMap.get(x, y);\n      const { r, g, b, a } = c;\n      ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n      ctx.fillRect(x * size, y * size, size, size);\n    }\n  return canvas;\n}\n\nexport function useBitMap2Image(ref: React.MutableRefObject<HTMLCanvasElement>, bitMap: BitMap<Color>, size: number) {\n  useEffect(() => {\n    if (ref.current) {\n      const canvas = ref.current;\n      const { width, height } = bitMap;\n      canvas.width = width * size;\n      canvas.height = height * size;\n      const ctx = canvas.getContext('2d');\n      for (let x = 0; x < width; x++)\n        for (let y = 0; y < height; y++) {\n          const c = bitMap.get(x, y);\n          const { r, g, b, a } = c;\n          ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n          ctx.fillRect(x * size, y * size, size, size);\n        }\n      // const src = ctx.getImageData(0,0,canvas.width,canvas.height);\n      // console.log('src',src)\n      // const data = window.bex.bild.effect.invert(src)\n      // console.log('data',data);\n      // ctx.putImageData(data,0,0)\n    }\n  }, [])\n}\n\nexport function bitMap2Bin(bitMap: BitMap<Color>): ImageData {\n  const { width, height } = bitMap;\n  const data = new Uint8ClampedArray(width * height * 4);\n  for (let x = 0; x < width; x++)\n    for (let y = 0; y < height; y++) {\n      const { r, g, b, a } = bitMap.get(x, y);\n      data.set([r, g, b, Math.floor(255 * a)], (x * width + y) * 4)\n    }\n  return new ImageData(data, width, height);\n}\n\nexport function imageData2Base64(imageData: ImageData): Bin {\n  return {\n    width: imageData.width,\n    height: imageData.height,\n    data: new Buffer(imageData.data.buffer).toString('base64')\n  }\n}\n\nexport function base642ImageData(data: Bin): ImageData {\n  return new ImageData(new Uint8ClampedArray(new Buffer(data.data, 'base64')), data.width, data.height)\n}\n\nexport function imageData2BitMap(data: ImageData): BitMap<Color> {\n  const { width, height } = data;\n  const m = new BitMap<Color>(width, height, Color.none);\n  for (let x = 0; x < width; x++)\n    for (let y = 0; y < height; y++) {\n      const [r, g, b, a] = Array.from(data.data.slice((x * width + y) * 4, (x * width + y + 1) * 4));\n      m.put(x, y, new Color(r, g, b, a / 255));\n    }\n  return m;\n}\n\n/**\n * bitMap 转 base64\n * @param bitMap \n */\nexport const bitMap2Base64 = (bitMap: BitMap<Color>) => imageData2Base64(bitMap2Bin(bitMap));\n\n/**\n * base64 转 bitMap\n * @param bin \n */\nexport const base642BitMap = (bin: Bin) => imageData2BitMap(base642ImageData(bin));\n\n\nexport function bitMap2ImageData(bitMap: BitMap<Color>, size: number = 20): ImageData {\n  return bitMap2Image(bitMap, size).getContext('2d').getImageData(0, 0, bitMap.width * size, bitMap.height * size)\n}"],"sourceRoot":""}